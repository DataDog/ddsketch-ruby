require 'distribution'

describe "DDSketch" do

  TEST_QUANTILES = [0, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99, 0.999, 1]
  TEST_SIZES = [3, 5, 10, 100, 1000]

  TEST_REL_ACC = 0.05

  shared_examples "test sketch" do |*args|

    class TestDataset
      attr_reader :size, :data

      def initialize(size)
        @size = size
        @data = populate
      end

      def name
        self.class.name
      end

      def sum
        @data.sum
      end

      def length
        size
      end

      def avg
        sum.to_f / length
      end

      # def rank(self, value):
      #   lower = np.array(sorted(self.data)) < value
      #   if np.all(lower):
      #       return self.size - 1
      #   else:
      #       return np.argmin(lower)

      def quantile(q)
        sorted = data.sort
        rank = Integer(q * (size - 1))
        sorted[rank]
      end

      protected

      def populate
        raise
      end

    end

    class EmptyDataset < TestDataset
      def populate
        []
      end

      def add(val)
        @size += 1
        data.append(val)
      end
    end

    class UniformForward < TestDataset
      def populate
        size.times.map {|i| i }
      end
    end

    class UniformBackward < TestDataset
      def populate
        size.times.map {|i| size - i }
      end
    end

    class NegativeUniformForward < TestDataset
      def populate
        Array.new(size) {|i| i - size }
      end
    end

    class NegativeUniformBackward < TestDataset
      def populate
        size.times.map {|i| -i }
      end
    end

    class NumberLineForward < TestDataset
      def populate
        ((-size/2 + 1)...(size/2 + 1)).to_a
      end
    end

    class NumberLineBackward < TestDataset
      def populate
        ((-size/2 + 1)...(size/2 + 1)).to_a.reverse
      end
    end

    class UniformZoomIn < TestDataset
      def populate
        arr = []

        if size % 2 == 1
          for item in (0...(size / 2))
            arr << item
            arr << size - item - 1
          end

          arr << size / 2
        else
          for item in (0...(size / 2))
            arr << item
            arr << size - item - 1
          end
        end

        arr
      end
    end
    class UniformZoomOut < TestDataset
      def populate
        arr = []

        if size % 2 == 1
          arr << (size / 2)
          half = size / 2

          for item in (1...(half + 1))
            arr << half + item
            arr << half - item
          end

        else
          half = (size.to_f / 2).ceil
          for item in (0...(half))
            arr << half + item
            arr << half - item - 1
          end

        end

        arr
      end
    end
    class UniformSqrt < TestDataset
      def populate
        arr = []

        t = Math.sqrt(2 * size)
        initial_item = 0
        initial_skip = 1
        emitted = 0
        i = 0

        while emitted < size
          item = initial_item
          skip = initial_skip
          for j in (0...(t - i))
            if item < size
              arr << item
              emitted += 1
            end
            item += skip
            skip += 1
          end

          if t - i > 1
            initial_skip += 1
            initial_item += initial_skip
            i += 1
          else
            initial_item += 1
          end
        end

        arr
      end
    end
    class Constant < TestDataset
      def populate
        [42] * size
      end
    end

    class Exponential < TestDataset
      def initialize
        super(1000)
      end

      def populate
        [3.89548113e-03, 3.72411426e-04, 1.64659318e-02, 3.18718947e-02,
          7.17683705e-03, 4.67763463e-03, 2.64992998e-02, 1.21677579e-03,
          1.08547160e-02, 1.74272650e-03, 1.15476572e-02, 8.54333625e-03,
          1.34786455e-03, 1.59815124e-03, 2.47878560e-03, 5.64352950e-03,
          2.83387013e-04, 2.19830393e-04, 1.46295013e-05, 1.66648003e-03,
          1.69155618e-02, 1.38509489e-02, 5.95649319e-03, 8.42097684e-03,
          1.98846833e-02, 7.50729110e-03, 2.88757563e-03, 1.96829651e-02,
          4.07556111e-03, 5.40316556e-03, 2.03770114e-03, 9.82762357e-03,
          3.76709713e-02, 8.39728746e-03, 8.69629520e-03, 5.49340888e-04,
          2.19662691e-02, 4.57091584e-03, 9.45398939e-03, 3.60966558e-03,
          1.36103470e-02, 1.19134483e-03, 7.26132045e-03, 1.02334711e-02,
          3.27302483e-03, 1.12899704e-02, 1.29520482e-02, 2.01793971e-02,
          2.28110831e-02, 5.15561949e-04, 1.93137555e-03, 1.45677803e-03,
          1.08850944e-02, 2.28879285e-02, 2.01738878e-02, 6.95333106e-04,
          3.50530893e-03, 7.94930870e-04, 1.51478514e-02, 2.79805254e-02,
          2.91216100e-03, 1.48168816e-02, 3.51441624e-03, 1.82532788e-02,
          1.59748573e-03, 4.06312670e-03, 2.23697557e-03, 8.56366613e-03,
          3.26512091e-02, 2.41108455e-03, 1.88599642e-02, 4.26688422e-03,
          8.20355384e-03, 1.63390057e-02, 1.59905753e-02, 8.72442505e-03,
          1.91658348e-02, 4.25987188e-02, 3.65680195e-03, 2.82703561e-03,
          1.70276979e-02, 1.19764613e-02, 4.14932499e-03, 1.90202060e-02,
          1.30627698e-02, 6.66147921e-03, 1.80122341e-03, 6.12382882e-03,
          4.16923199e-03, 4.69197647e-04, 5.56819321e-03, 7.85643366e-03,
          1.96777217e-02, 6.50341677e-03, 5.03678852e-03, 3.27284311e-03,
          1.56578005e-02, 1.49689758e-03, 9.06359493e-03, 4.08612414e-02,
          5.50170950e-03, 5.50495096e-02, 6.05457883e-03, 2.03881984e-02,
          8.44450395e-03, 2.73111233e-03, 7.13181475e-04, 5.88452479e-03,
          5.17713546e-02, 4.22085804e-03, 6.56528443e-04, 9.27762418e-04,
          1.73466204e-02, 1.68393235e-03, 1.80763713e-03, 3.30089548e-02,
          4.79184863e-03, 2.75452819e-02, 2.43252693e-03, 1.53367872e-03,
          2.24642370e-02, 2.06700386e-03, 1.65407303e-02, 3.45661160e-02,
          7.57473231e-03, 4.39935501e-04, 2.21353690e-03, 2.72247355e-03,
          2.24067101e-03, 4.43318552e-03, 2.07426249e-02, 6.37304778e-03,
          2.05341207e-02, 8.79105859e-03, 8.77489928e-03, 2.19247711e-02,
          2.85857340e-02, 1.72291193e-02, 8.95256115e-03, 5.09177849e-03,
          6.74473057e-03, 1.56584514e-02, 3.77820556e-03, 2.96602254e-03,
          6.46413084e-03, 2.14492293e-02, 3.35061485e-02, 7.11665096e-03,
          2.11958487e-02, 1.38364747e-03, 6.37505476e-04, 1.40475453e-02,
          9.43011330e-03, 4.44368749e-03, 1.78520115e-02, 4.96378262e-02,
          2.96088797e-02, 4.95507824e-03, 6.35838346e-05, 1.37109259e-02,
          7.27406128e-03, 9.86529991e-04, 7.58678181e-03, 4.56346437e-03,
          5.86202335e-03, 6.59179815e-03, 3.29725151e-03, 1.34796270e-02,
          3.61632605e-02, 5.31950332e-03, 4.53226696e-03, 2.03006316e-02,
          4.54186633e-02, 2.39088971e-02, 3.10724066e-02, 3.95243349e-03,
          2.02290946e-03, 6.44182505e-03, 9.70665354e-03, 4.88173937e-03,
          2.15805131e-02, 1.18586527e-02, 4.03505954e-03, 4.03968956e-03,
          1.20320128e-02, 1.04317727e-03, 2.92123410e-03, 2.81092032e-03,
          3.94526662e-03, 1.50066948e-02, 8.50428504e-03, 1.15109929e-02,
          2.97621216e-03, 1.33553528e-02, 7.86956619e-03, 1.01303361e-03,
          4.45812301e-03, 1.08101446e-02, 2.22363570e-03, 7.89839632e-03,
          4.10180650e-04, 1.18346423e-03, 1.60528846e-02, 1.13200546e-02,
          5.59073405e-03, 3.50113322e-03, 2.90528635e-04, 2.79173521e-02,
          2.03692458e-02, 4.54383329e-03, 1.98225788e-04, 1.23759332e-02,
          1.70179410e-03, 9.08521797e-04, 2.64682160e-03, 2.64070184e-02,
          4.46020465e-03, 1.13942265e-02, 2.76367194e-04, 2.95432361e-03,
          3.17827749e-02, 3.90818079e-03, 1.76916261e-02, 2.00333675e-02,
          1.05130455e-02, 1.25332918e-02, 1.49903221e-02, 7.08126997e-04,
          5.94742871e-03, 4.77365615e-03, 1.00550103e-03, 1.10698219e-02,
          1.72672606e-02, 1.53545895e-02, 4.76788354e-04, 1.01018520e-02,
          2.73864447e-03, 5.58040299e-04, 4.36518031e-03, 6.69702428e-03,
          1.54353051e-02, 5.99067407e-03, 2.82142969e-03, 3.10187368e-03,
          1.52318333e-02, 1.93884733e-02, 1.21067929e-02, 4.49163033e-02,
          5.24868790e-03, 3.70047321e-02, 4.18844167e-02, 6.71677364e-03,
          2.49763330e-02, 1.38537812e-02, 2.41162686e-02, 2.67922455e-03,
          1.08773147e-02, 2.07015861e-02, 7.68689313e-03, 2.42777991e-04,
          3.42805746e-03, 7.07634320e-03, 3.15579745e-03, 2.75934805e-02,
          2.38754430e-02, 2.02886309e-02, 5.02626915e-04, 5.58067197e-03,
          1.19341235e-02, 4.29906870e-03, 1.88951880e-02, 1.16620275e-02,
          2.26036196e-02, 6.64405784e-03, 7.45325470e-03, 5.80472765e-03,
          1.25958771e-02, 7.36905320e-03, 1.18204879e-02, 2.48436725e-03,
          5.44374170e-05, 2.13854763e-03, 1.46250494e-03, 1.17825937e-03,
          4.82494579e-04, 1.76119417e-02, 3.65155755e-02, 4.82173409e-03,
          1.50924357e-02, 1.10545396e-02, 4.90854158e-03, 2.10106359e-02,
          2.77801545e-02, 4.72676777e-04, 6.04515218e-03, 8.07653249e-03,
          4.79171044e-03, 5.93372874e-02, 2.43491494e-03, 1.06398615e-03,
          1.85297114e-02, 6.10454317e-03, 5.70685439e-03, 4.55952060e-04,
          4.25345448e-03, 2.13762267e-02, 5.50589766e-03, 8.55349710e-04,
          9.47583758e-03, 8.64839502e-04, 1.02239282e-02, 1.23664234e-02,
          3.15702342e-02, 2.31685477e-02, 5.53030949e-04, 3.09125976e-03,
          8.85073142e-03, 6.03845810e-04, 1.33227549e-02, 3.16728026e-03,
          3.77510234e-05, 2.28324829e-03, 1.09777434e-02, 1.25632720e-02,
          8.51707526e-03, 8.88534905e-04, 1.01476783e-02, 8.64369298e-03,
          3.81594563e-03, 1.30415349e-02, 3.13414454e-03, 6.85771358e-03,
          2.67374399e-02, 2.27586035e-02, 1.83364731e-02, 4.12103429e-02,
          2.58543689e-03, 3.77419160e-02, 5.30025467e-03, 7.60438717e-03,
          2.25001522e-03, 2.90479224e-02, 1.72131399e-02, 2.71694844e-03,
          5.56182692e-04, 4.49272032e-02, 1.27696526e-03, 7.77745208e-03,
          2.45094807e-02, 2.82832139e-03, 1.54496719e-03, 9.22702269e-03,
          8.51418929e-03, 4.23830895e-04, 6.82962674e-03, 6.27822992e-04,
          1.22885922e-02, 1.62463088e-03, 5.53158220e-03, 1.61739516e-03,
          7.25041729e-03, 1.14060202e-03, 2.01389282e-02, 1.42323152e-02,
          1.50487648e-02, 7.93612156e-03, 1.19364448e-02, 1.31579926e-03,
          2.92657090e-02, 1.15624326e-02, 3.57278511e-03, 5.01520092e-03,
          9.90170600e-03, 6.96384093e-03, 1.04324925e-02, 3.59878788e-03,
          1.67177169e-03, 3.33604736e-05, 4.65840015e-03, 3.88648921e-02,
          9.12164671e-03, 2.98940964e-02, 5.50698934e-03, 3.67702922e-03,
          2.79048955e-03, 5.81319631e-03, 8.45674243e-05, 1.51617803e-02,
          1.84340390e-03, 4.15060569e-03, 7.06082273e-04, 7.18535924e-03,
          1.01359036e-02, 4.54233504e-03, 1.02533990e-02, 9.24200951e-04,
          1.46926432e-03, 1.84410117e-02, 3.26031838e-02, 2.12687817e-03,
          2.95402714e-03, 1.55665403e-02, 6.39132408e-04, 4.09746124e-03,
          4.44297428e-04, 1.47733428e-03, 4.47550794e-04, 3.47916185e-03,
          1.72670823e-02, 3.44775236e-02, 2.35442989e-02, 1.08697918e-02,
          3.43194620e-03, 1.25402879e-03, 1.48735108e-03, 1.69836278e-03,
          1.31727035e-02, 1.37417176e-03, 1.52510836e-02, 4.22612977e-03,
          6.51569630e-03, 4.95029433e-03, 1.94728582e-05, 6.44757587e-03,
          1.45941478e-03, 8.92908158e-03, 6.99325947e-03, 1.20037004e-02,
          3.87759395e-03, 1.40085329e-02, 2.60747883e-02, 3.88924335e-03,
          1.02280952e-03, 6.59266027e-03, 2.10686042e-02, 1.14524596e-02,
          1.52974657e-02, 1.12314451e-02, 1.02017434e-02, 8.59918811e-03,
          5.19550699e-02, 2.64113336e-03, 1.79665103e-03, 4.85911268e-03,
          1.35318428e-02, 8.93518516e-03, 2.23661147e-03, 8.04262520e-03,
          1.88667476e-02, 9.08571359e-04, 9.46086806e-03, 4.04926163e-03,
          9.96368501e-03, 1.13143183e-02, 5.81067165e-04, 6.79219280e-03,
          2.87441602e-02, 1.62248440e-03, 5.52293234e-03, 1.23345279e-03,
          1.45572444e-02, 1.07164414e-02, 1.75779556e-02, 3.91670511e-03,
          7.41504193e-03, 6.49141499e-03, 9.47381803e-03, 5.29156693e-04,
          3.36077720e-02, 9.47924900e-03, 3.82175483e-03, 3.89270449e-03,
          2.73841935e-02, 2.31659778e-02, 6.02706766e-03, 4.29070396e-03,
          1.49404498e-02, 9.49177726e-03, 2.80630142e-03, 2.85668464e-03,
          1.19379414e-02, 9.93786043e-03, 2.13446633e-03, 1.43515882e-02,
          3.39983454e-03, 1.39702871e-03, 7.99635549e-03, 1.55302916e-02,
          1.71768590e-03, 1.86358332e-02, 4.11166535e-03, 9.51699581e-04,
          1.46920327e-02, 6.85098500e-03, 4.34882165e-03, 1.18716915e-02,
          7.68786000e-03, 9.62553908e-03, 5.84022293e-03, 7.70857630e-03,
          6.62590399e-03, 2.88922299e-03, 2.90024280e-03, 1.04574363e-02,
          3.23749272e-04, 8.93565739e-04, 3.35123966e-04, 2.27862713e-04,
          8.65410422e-03, 3.45870000e-03, 2.06638982e-03, 2.59382401e-02,
          1.76378998e-02, 1.64140418e-03, 4.99620832e-03, 1.73611168e-03,
          6.02351172e-03, 7.37623606e-03, 2.15537901e-02, 1.07189152e-02,
          9.13894281e-03, 3.60101180e-04, 2.38925484e-03, 5.23033506e-03,
          2.50424794e-03, 2.09242505e-02, 5.27848534e-03, 5.98297158e-03,
          1.44197800e-02, 2.32456369e-02, 9.44687243e-04, 1.80946918e-02,
          6.58028363e-03, 3.14971335e-03, 4.97177840e-02, 3.37302590e-03,
          1.68194009e-03, 4.09026113e-02, 3.60405574e-04, 9.82823229e-03,
          9.71486198e-03, 1.69446219e-02, 4.19234844e-03, 1.06034509e-02,
          2.36903487e-03, 1.86547179e-02, 3.94492819e-03, 6.27646407e-03,
          8.70187443e-03, 2.99628975e-03, 1.69895783e-02, 6.36710284e-03,
          5.32242539e-04, 1.83294935e-02, 1.63615059e-03, 1.98415404e-03,
          9.86612241e-03, 3.33084155e-03, 3.57495500e-04, 2.43063892e-02,
          2.43182744e-02, 1.16388204e-02, 2.75589704e-03, 1.46471870e-03,
          2.29195068e-04, 2.40182083e-02, 1.91607001e-02, 1.41801440e-02,
          1.33663902e-02, 2.03260445e-03, 9.29668473e-03, 2.54019585e-02,
          2.28078515e-02, 4.11680434e-03, 5.30973405e-02, 1.33639412e-02,
          2.21898532e-02, 4.46067050e-03, 5.21607021e-03, 1.24538782e-02,
          9.91562076e-03, 1.22227312e-03, 1.64045287e-02, 1.01244250e-02,
          8.50995924e-03, 2.93676688e-03, 1.36455264e-02, 5.29721248e-03,
          3.14468320e-03, 1.22777646e-02, 1.19612782e-02, 1.41443762e-02,
          2.36252329e-02, 1.09981321e-02, 2.76422654e-03, 7.12591423e-04,
          1.39033042e-02, 8.96858099e-03, 2.31627070e-02, 5.80194061e-03,
          3.42226864e-03, 4.21500862e-03, 8.21833486e-03, 5.12919808e-03,
          5.55173838e-03, 1.51077167e-03, 1.49547479e-02, 2.68682356e-03,
          5.97302881e-03, 1.54638981e-02, 1.28248423e-02, 1.05091704e-02,
          1.62886093e-02, 1.96177918e-03, 1.19279190e-02, 1.06833657e-02,
          4.22066696e-03, 7.68316717e-03, 1.56858427e-02, 1.46561910e-02,
          4.46749079e-04, 1.07073325e-02, 2.40863048e-02, 2.43482069e-03,
          4.15523673e-03, 3.35836773e-04, 3.05203192e-03, 4.90326819e-03,
          1.95216964e-03, 4.21505539e-03, 3.56775024e-03, 1.34966791e-02,
          2.98004188e-03, 1.61451381e-02, 2.21493658e-02, 3.75503364e-03,
          9.11411898e-03, 1.54460233e-04, 3.08802068e-04, 9.70137668e-03,
          3.41978380e-03, 1.04775905e-03, 3.21119654e-02, 8.89504117e-03,
          1.17804763e-02, 1.11272045e-03, 2.65369585e-02, 5.46165080e-03,
          1.23214085e-02, 2.06107346e-02, 1.49767842e-03, 4.62611162e-03,
          3.75305087e-03, 7.05605097e-03, 5.01609271e-02, 1.72427480e-02,
          4.81089971e-03, 1.98378173e-02, 7.96305869e-03, 7.92325657e-03,
          1.53518662e-02, 1.15131368e-02, 6.62529853e-03, 2.56853478e-03,
          5.03397066e-03, 2.90827518e-04, 3.34582179e-03, 1.20534208e-02,
          1.64808776e-02, 1.01652931e-02, 2.58672609e-02, 6.72907730e-03,
          1.39934928e-02, 2.39141341e-03, 2.68991429e-03, 7.86516572e-03,
          1.46359346e-02, 1.52832272e-02, 1.96195263e-02, 1.95915409e-02,
          2.27018513e-03, 1.41483952e-02, 2.48137663e-03, 1.20978195e-02,
          1.42129982e-02, 1.27452880e-02, 3.19548640e-03, 5.11919145e-03,
          3.34075574e-02, 2.73378123e-02, 1.17668143e-03, 6.86682651e-04,
          3.13155246e-02, 2.75750223e-03, 9.26155593e-03, 1.85238588e-02,
          1.29530508e-02, 1.20644175e-02, 2.40778595e-02, 8.20741132e-04,
          2.19625479e-03, 5.66647793e-03, 1.30729115e-04, 4.16929028e-03,
          5.07598043e-03, 2.56964325e-03, 1.54525617e-03, 4.81378740e-02,
          1.08576983e-02, 7.67884240e-04, 3.04924518e-02, 1.74686884e-02,
          7.41165762e-03, 6.98161719e-03, 3.94924803e-03, 1.71290501e-02,
          7.56986014e-03, 6.63328012e-02, 1.38926504e-02, 3.88100076e-03,
          2.45654167e-02, 9.32995071e-03, 1.27404245e-02, 2.12735680e-02,
          5.17667417e-02, 8.53116377e-04, 2.40200165e-03, 5.01141658e-04,
          2.34698366e-03, 2.03735172e-03, 1.27565325e-03, 3.61035803e-03,
          3.95006165e-03, 6.10436827e-03, 1.66499423e-02, 3.93655506e-03,
          9.30422572e-03, 7.47830318e-03, 4.92223892e-02, 4.98065462e-03,
          2.55243001e-02, 2.28163704e-03, 1.41966395e-03, 1.02083398e-02,
          3.15546856e-03, 2.48889413e-03, 1.15909539e-02, 3.91322988e-03,
          7.52326011e-03, 6.83691430e-03, 7.04575873e-04, 1.79932251e-03,
          1.13820741e-02, 7.83927109e-03, 9.24291000e-03, 2.57181224e-03,
          2.11429025e-02, 7.65269294e-03, 4.52027911e-03, 8.46796545e-04,
          4.94853970e-03, 1.53230561e-02, 2.21461047e-02, 1.04206509e-02,
          1.72484767e-02, 3.12029411e-02, 2.34206551e-03, 5.75817939e-03,
          1.20980262e-02, 2.94043554e-02, 1.30910276e-03, 6.38986344e-04,
          2.02006648e-02, 5.35687139e-03, 3.58684808e-02, 8.01437550e-05,
          1.21589621e-05, 1.02540489e-03, 3.71872528e-03, 3.69678387e-03,
          8.10284703e-03, 1.53237919e-02, 1.00416928e-02, 1.14534595e-02,
          1.15139017e-02, 4.47230011e-03, 7.26520151e-06, 1.01307996e-02,
          3.55904111e-03, 2.11403236e-02, 7.43963593e-03, 7.86170794e-04,
          9.94899458e-03, 7.28136082e-03, 3.77474743e-03, 5.57912022e-04,
          1.99058191e-02, 1.03402286e-02, 8.04899254e-04, 4.15426042e-03,
          4.70795381e-04, 8.76051344e-03, 3.60001836e-03, 5.02656695e-04,
          2.65718716e-02, 5.41868092e-04, 4.18145389e-03, 1.81943915e-02,
          2.96449165e-02, 7.44850659e-05, 1.34002164e-02, 2.05278982e-02,
          4.73396006e-03, 1.96819269e-02, 1.39290976e-03, 8.65135419e-03,
          2.03384918e-02, 2.56593345e-03, 9.20052334e-03, 1.47019656e-03,
          1.11436590e-03, 1.06590350e-02, 3.82515784e-03, 2.55976522e-02,
          8.75356932e-03, 1.37104092e-02, 3.45204020e-03, 7.39688810e-03,
          1.71331889e-02, 1.86045318e-03, 7.29299157e-03, 1.86100555e-02,
          9.69858666e-03, 9.04750606e-03, 5.88921933e-03, 5.57760934e-03,
          6.67891209e-03, 2.65557726e-02, 1.27707347e-02, 1.43170125e-02,
          6.64744920e-03, 2.17264189e-02, 1.25392733e-02, 2.40035008e-03,
          6.16604788e-03, 2.76327521e-03, 2.95294135e-02, 1.90328698e-02,
          2.50368582e-02, 1.16836197e-02, 2.42245170e-02, 1.28498649e-02,
          1.34850658e-02, 1.25219422e-02, 1.52563371e-02, 7.89814284e-03,
          5.22996921e-03, 1.37806299e-02, 5.69679506e-05, 7.04991330e-03,
          6.13194668e-03, 2.02184515e-02, 3.35970197e-03, 8.35930454e-03,
          1.67545997e-02, 8.66227126e-03, 8.60102682e-03, 6.35588432e-03,
          1.61532401e-02, 1.65705119e-03, 7.16192425e-03, 6.32380086e-03,
          1.68840442e-02, 2.06777995e-04, 6.58927761e-03, 3.12155162e-03,
          8.82070794e-03, 2.35197023e-03, 1.27607856e-02, 2.28825823e-02,
          1.67212896e-02, 3.06637828e-02, 3.44806750e-03, 1.49953500e-03,
          1.77229940e-02, 1.19640621e-02, 3.12443753e-02, 6.30312986e-03,
          2.91463260e-03, 2.75047768e-02, 2.69139475e-02, 1.21992811e-03,
          9.54234498e-03, 7.08440126e-03, 2.10548090e-03, 3.58002669e-03,
          2.25544268e-02, 4.10174074e-03, 6.71776008e-03, 1.87179279e-02,
          2.50845984e-02, 7.83898301e-03, 3.70956582e-03, 6.02441127e-04,
          2.98513675e-03, 1.37226982e-02, 8.38950411e-04, 8.85575493e-04,
          4.16347715e-03, 3.43815756e-03, 6.30628533e-03, 1.21090669e-02,
          1.33617796e-02, 6.95001291e-03, 6.47323483e-04, 6.61626180e-03,
          2.37092450e-02, 4.84458613e-02, 3.73366477e-03, 5.49335021e-03,
          1.11184782e-02, 1.08272951e-02, 1.03519799e-02, 1.13274290e-03,
          2.48381802e-03, 1.74339155e-02, 2.33198206e-02, 2.34998528e-02,
          1.09539659e-03, 5.75335630e-03, 1.07920981e-03, 4.19320358e-03,
          1.04218088e-02, 7.81994460e-03, 1.92729817e-02, 1.28677063e-02,
          4.91099457e-03, 5.58595141e-04, 1.95664564e-04, 5.31952488e-03,
          7.37214342e-03, 1.05191917e-02, 1.02009235e-02, 3.38854122e-03,
          6.91033672e-03, 9.81949765e-05, 3.60149499e-05, 2.01980950e-02,
          2.20278666e-03, 1.25654942e-03, 1.26434899e-03, 6.85445761e-03,
          2.35020605e-03, 7.09935393e-03, 5.62977130e-03, 9.96070196e-04,
          1.15505180e-02, 2.06155941e-02, 1.66183831e-02, 2.78522718e-02,
          3.23309545e-02, 1.54302286e-02, 5.00206391e-04, 1.70783852e-03,
          1.95321803e-03, 8.09372429e-03, 4.81918815e-02, 6.18665814e-03,
          8.38410059e-03, 2.51748542e-03, 2.93645544e-02, 4.59950625e-03,
          1.49208440e-02, 3.47309833e-04, 1.02913545e-02, 6.68362445e-03,
          8.56986497e-03, 1.76021522e-02, 2.12186675e-03, 1.36924178e-02,
          4.18931908e-03, 1.93348878e-02, 2.56627353e-02, 2.81929894e-02,
          3.36376931e-03, 1.60083002e-02, 3.34934548e-03, 5.41610611e-04,
          1.06512814e-02, 2.31723281e-03, 1.47806978e-02, 2.90551405e-02,
          1.86874950e-02, 1.34858948e-02, 9.23780585e-03, 1.05344360e-02,
          1.39963307e-02, 1.64318803e-02, 2.64298660e-03, 3.32176760e-02]
      end

    end

    class Lognormal < TestDataset
      def initialize
        super(1000)
      end

      def populate
        [0.00799717, 0.00654048, 0.0030165 , 0.00209251, 0.01624538,
          0.00521887, 0.00803425, 0.02299255, 0.00536431, 0.00712741,
          0.00329268, 0.00335803, 0.01519587, 0.00094341, 0.00241419,
          0.0915987 , 0.1031509 , 0.03645131, 0.00928911, 0.01281211,
          0.01441872, 0.00901095, 0.01576623, 0.0150816 , 0.01595652,
          0.0202284 , 0.01008505, 0.00645223, 0.01810956, 0.00874571,
          0.03987766, 0.01115602, 0.01306009, 0.00504775, 0.00289034,
          0.00948101, 0.00784775, 0.00254442, 0.00556894, 0.00087509,
          0.01231298, 0.02226404, 0.00468126, 0.06094186, 0.01176149,
          0.00384032, 0.00124043, 0.059936  , 0.03368846, 0.00813183,
          0.01617471, 0.00651474, 0.00439377, 0.01149821, 0.00426423,
          0.01722531, 0.00152479, 0.00972673, 0.00534086, 0.03118853,
          0.01407756, 0.06516066, 0.00348144, 0.01718008, 0.00611387,
          0.01832826, 0.02009695, 0.00168674, 0.00413445, 0.01718027,
          0.03792285, 0.00257656, 0.01397264, 0.00844602, 0.00757827,
          0.00179134, 0.03665102, 0.08956301, 0.01145121, 0.02309106,
          0.00100555, 0.00356164, 0.01930959, 0.01776752, 0.00067248,
          0.00408807, 0.07487889, 0.02090631, 0.0061529 , 0.04273116,
          0.05964437, 0.0319024 , 0.00423269, 0.00448977, 0.03194983,
          0.00428748, 0.02206606, 0.00591242, 0.0120909 , 0.00434129,
          0.0067222 , 0.01952656, 0.01763614, 0.00555561, 0.0027041 ,
          0.01088889, 0.00483059, 0.00637941, 0.01661052, 0.01424616,
          0.03419229, 0.00669569, 0.03634026, 0.00175934, 0.00401505,
          0.00500399, 0.0054626 , 0.03235846, 0.00228258, 0.01323907,
          0.00738099, 0.00690376, 0.00801893, 0.00394514, 0.01107072,
          0.01054896, 0.00585526, 0.00406203, 0.02122632, 0.00929457,
          0.01229097, 0.01623223, 0.00083169, 0.01789312, 0.0203195 ,
          0.02027348, 0.00996191, 0.00178155, 0.00485207, 0.02009394,
          0.00662834, 0.00248295, 0.00410146, 0.01088885, 0.00216407,
          0.00174306, 0.08399512, 0.00869962, 0.00528205, 0.00291086,
          0.01726634, 0.03005046, 0.01703146, 0.04093387, 0.01144596,
          0.07681821, 0.01269515, 0.00634795, 0.03409845, 0.00453739,
          0.00920743, 0.00620966, 0.00794762, 0.01632452, 0.00240089,
          0.00258514, 0.0047652 , 0.04420196, 0.00678036, 0.01955272,
          0.0321601 , 0.00299468, 0.02756244, 0.01759375, 0.00998257,
          0.02264857, 0.00856668, 0.01797125, 0.02116078, 0.00442178,
          0.0018815 , 0.01719496, 0.00852354, 0.01207507, 0.00223491,
          0.00733906, 0.00406283, 0.01357038, 0.03459756, 0.01112873,
          0.01450917, 0.00822755, 0.0117708 , 0.01083861, 0.00266603,
          0.01420887, 0.0033382 , 0.01525468, 0.01336825, 0.0014097 ,
          0.00172103, 0.05481797, 0.00983445, 0.00590911, 0.01130841,
          0.00792264, 0.00237857, 0.01533994, 0.00801684, 0.03346119,
          0.01026459, 0.0165501 , 0.00341012, 0.01191791, 0.05084512,
          0.00225372, 0.00349153, 0.0059601 , 0.00626598, 0.07523693,
          0.00676707, 0.00217344, 0.03988109, 0.01669705, 0.00806864,
          0.02234518, 0.0224427 , 0.04091235, 0.00256036, 0.00461771,
          0.01536313, 0.00710168, 0.02293514, 0.00404178, 0.02651324,
          0.00784965, 0.00459099, 0.00192897, 0.02539509, 0.0074283 ,
          0.02265975, 0.01727837, 0.00956238, 0.00435068, 0.03748838,
          0.01887739, 0.01961887, 0.01748031, 0.00798724, 0.01136935,
          0.04638614, 0.01646318, 0.00563539, 0.03024903, 0.00824451,
          0.02455916, 0.07639626, 0.00606784, 0.01150414, 0.00224319,
          0.00921856, 0.0189337 , 0.02180032, 0.00489216, 0.00553587,
          0.02758099, 0.00923422, 0.01930307, 0.01779117, 0.01472826,
          0.01204323, 0.00993382, 0.00933675, 0.02814819, 0.02303583,
          0.00473182, 0.00204372, 0.0132499 , 0.01695211, 0.02870205,
          0.09194148, 0.00517201, 0.00226655, 0.01505359, 0.00971648,
          0.01326055, 0.01018786, 0.00583671, 0.00324936, 0.01275095,
          0.04420185, 0.00971816, 0.00394725, 0.00291539, 0.01604736,
          0.00562451, 0.00920531, 0.00516195, 0.00277383, 0.02521089,
          0.005025  , 0.01152879, 0.00713923, 0.0201592 , 0.02133373,
          0.00052884, 0.01337459, 0.00230405, 0.00733451, 0.00626438,
          0.01409766, 0.01726623, 0.00813827, 0.01515257, 0.02041706,
          0.15071205, 0.02940511, 0.00116123, 0.01154099, 0.00759479,
          0.05911486, 0.00394282, 0.01336369, 0.00280335, 0.02782124,
          0.00098105, 0.01593177, 0.00061988, 0.0015611 , 0.01289437,
          0.00619828, 0.00319427, 0.01782354, 0.01589462, 0.00429939,
          0.01275154, 0.02958537, 0.01924431, 0.05521099, 0.04524454,
          0.0119778 , 0.00081117, 0.01282452, 0.01660826, 0.00582545,
          0.00229531, 0.01956502, 0.0160454 , 0.00529398, 0.00996997,
          0.02480179, 0.03642654, 0.00631326, 0.00351879, 0.00256748,
          0.00890601, 0.01905557, 0.00767335, 0.01491859, 0.02306124,
          0.01197973, 0.01436823, 0.03450988, 0.01063979, 0.00762015,
          0.06774354, 0.01320103, 0.00464334, 0.00587092, 0.0027693 ,
          0.01340483, 0.00858592, 0.05196842, 0.01277244, 0.00221028,
          0.02873345, 0.01820328, 0.01052288, 0.01649771, 0.00679801,
          0.01354945, 0.01708822, 0.00544639, 0.00875666, 0.05105958,
          0.0019182 , 0.00219878, 0.0097647 , 0.02016229, 0.00067729,
          0.00472428, 0.01413745, 0.02624629, 0.01102322, 0.02964839,
          0.02573395, 0.06358223, 0.00694528, 0.00254503, 0.00269359,
          0.00714773, 0.00219733, 0.00633761, 0.08278985, 0.04705757,
          0.01019816, 0.00966916, 0.0063807 , 0.03391046, 0.0578608 ,
          0.03247832, 0.02533928, 0.04033624, 0.03545598, 0.02161558,
          0.02607213, 0.0073247 , 0.00960807, 0.00121141, 0.00837563,
          0.00900229, 0.0162263 , 0.09201464, 0.0060125 , 0.02346186,
          0.01150178, 0.02028516, 0.01808874, 0.01347536, 0.0035976 ,
          0.01876846, 0.00362791, 0.02583155, 0.01465851, 0.01557696,
          0.00150531, 0.03579795, 0.04219265, 0.01612055, 0.04712796,
          0.00443481, 0.00811482, 0.02966127, 0.00722275, 0.0113966 ,
          0.00260687, 0.01266276, 0.00289622, 0.0824707 , 0.08507091,
          0.04623101, 0.002252  , 0.00753134, 0.02868568, 0.0383101 ,
          0.01007889, 0.00809212, 0.0118036 , 0.06380265, 0.01327912,
          0.00190886, 0.00290228, 0.01024618, 0.00702678, 0.0016716 ,
          0.00310314, 0.01559982, 0.0054689 , 0.0222723 , 0.00793383,
          0.03248876, 0.02417763, 0.01671494, 0.00796439, 0.00413403,
          0.00290945, 0.04968691, 0.02776728, 0.01371551, 0.00388973,
          0.00626852, 0.0108571 , 0.00246343, 0.02211812, 0.02032848,
          0.00241452, 0.01563267, 0.01292684, 0.01441037, 0.01884904,
          0.06950245, 0.02421858, 0.01099718, 0.02438043, 0.00192257,
          0.00147634, 0.04455075, 0.01397635, 0.00313089, 0.01285082,
          0.00763483, 0.00493167, 0.00845607, 0.03269935, 0.00448169,
          0.00829948, 0.00351611, 0.01733758, 0.00222563, 0.00998874,
          0.00760736, 0.02798759, 0.03005603, 0.00464758, 0.02652964,
          0.00699961, 0.00379945, 0.00058335, 0.02450346, 0.00340024,
          0.00252845, 0.05720645, 0.02123371, 0.00609892, 0.00359421,
          0.01190771, 0.0110777 , 0.01490888, 0.0050135 , 0.00366849,
          0.01636214, 0.0023548 , 0.01656566, 0.00571745, 0.01211623,
          0.00268128, 0.00453591, 0.0149848 , 0.04349322, 0.01285399,
          0.00527964, 0.00575348, 0.0083523 , 0.0156744 , 0.07328649,
          0.00802786, 0.0070861 , 0.00576548, 0.00462695, 0.00773229,
          0.00324897, 0.00217623, 0.01019795, 0.00358847, 0.00445434,
          0.04616458, 0.00671734, 0.05103064, 0.00224503, 0.00621669,
          0.00673513, 0.00406254, 0.0060373 , 0.00382352, 0.02393696,
          0.00861699, 0.13025095, 0.01648096, 0.00655301, 0.00323488,
          0.00166212, 0.0047565 , 0.06555621, 0.02239947, 0.03082178,
          0.00482473, 0.00285197, 0.00271664, 0.00188863, 0.0052435 ,
          0.02942448, 0.01067985, 0.00653161, 0.04628009, 0.00419731,
          0.03994531, 0.00357178, 0.00713948, 0.01399178, 0.00479442,
          0.01837396, 0.01157823, 0.02601047, 0.01087701, 0.10723974,
          0.04773003, 0.00356684, 0.00290999, 0.00561681, 0.00406241,
          0.01055311, 0.01802245, 0.02582544, 0.00483101, 0.00419817,
          0.00506086, 0.04262777, 0.02586188, 0.00579694, 0.00511964,
          0.03293626, 0.01398963, 0.00864628, 0.01836238, 0.00801353,
          0.03213949, 0.0036439 , 0.00063946, 0.0390536 , 0.02763235,
          0.02258107, 0.01354007, 0.00929346, 0.00675572, 0.00510294,
          0.009357  , 0.01874134, 0.01041367, 0.00562464, 0.04736357,
          0.00772767, 0.03346589, 0.00672025, 0.02401041, 0.00842956,
          0.00604756, 0.18471697, 0.00842728, 0.03502965, 0.00579687,
          0.01074235, 0.03844088, 0.00825273, 0.00632508, 0.00386241,
          0.02349666, 0.00467765, 0.0196718 , 0.00289177, 0.01367282,
          0.00263356, 0.00707315, 0.02941107, 0.00170147, 0.0030024 ,
          0.0042515 , 0.01246911, 0.00607   , 0.00675671, 0.03230006,
          0.01048689, 0.06995592, 0.10292904, 0.01690493, 0.02180926,
          0.04373488, 0.00458965, 0.02267941, 0.0116718 , 0.03263015,
          0.00361058, 0.00620916, 0.00238906, 0.00234936, 0.00159398,
          0.00600256, 0.00167117, 0.01938613, 0.00358289, 0.01966916,
          0.00412512, 0.00330325, 0.01105475, 0.00746853, 0.00827407,
          0.01515678, 0.00403702, 0.00278607, 0.01541981, 0.00220475,
          0.05300111, 0.02165196, 0.01947469, 0.01997531, 0.02373824,
          0.03524156, 0.0548729 , 0.0304723 , 0.02605359, 0.03786334,
          0.01535518, 0.02086508, 0.00940266, 0.03131734, 0.04812725,
          0.00748312, 0.00354625, 0.00676549, 0.01615122, 0.00465222,
          0.01551679, 0.00868384, 0.0106668 , 0.00279447, 0.02585679,
          0.03882781, 0.00355102, 0.03025106, 0.00606238, 0.01487603,
          0.01743097, 0.00238168, 0.00233527, 0.03265373, 0.01411848,
          0.00585879, 0.01802887, 0.00244134, 0.02722268, 0.05801008,
          0.0134863 , 0.01358771, 0.03619405, 0.01564233, 0.00607438,
          0.01062234, 0.00206547, 0.02282197, 0.02969077, 0.00308876,
          0.00836139, 0.00365687, 0.02405096, 0.01615777, 0.00707311,
          0.00612061, 0.00278711, 0.00746864, 0.00819977, 0.03643549,
          0.01725183, 0.00347431, 0.00289031, 0.00399313, 0.00422852,
          0.02316411, 0.00897828, 0.00229207, 0.01472924, 0.00458517,
          0.0073743 , 0.00366093, 0.00167199, 0.00389839, 0.00743326,
          0.01147144, 0.0061456 , 0.01316583, 0.00995116, 0.05167254,
          0.01565728, 0.0193574 , 0.01323712, 0.04994442, 0.01343371,
          0.00188332, 0.01476197, 0.00652856, 0.01752469, 0.00844757,
          0.02349074, 0.00053279, 0.02977751, 0.0064968 , 0.05861971,
          0.01335787, 0.018803  , 0.01944082, 0.00217714, 0.003825  ,
          0.01308012, 0.00467907, 0.00539603, 0.00107489, 0.03858932,
          0.0006428 , 0.01823611, 0.00214594, 0.00414594, 0.02641771,
          0.01616379, 0.01032224, 0.00414012, 0.00498883, 0.00396861,
          0.01644293, 0.0131069 , 0.00761332, 0.01295505, 0.03834558,
          0.01117491, 0.01651613, 0.02075332, 0.00736136, 0.00188015,
          0.00268525, 0.00134738, 0.01431546, 0.00329691, 0.0039459 ,
          0.00405968, 0.00457211, 0.01565789, 0.01213211, 0.00258991,
          0.01306944, 0.0019202 , 0.00852532, 0.01087982, 0.0109115 ,
          0.00632586, 0.01052664, 0.01337068, 0.02363982, 0.01006147,
          0.01657472, 0.05369105, 0.00290852, 0.01074408, 0.0075021 ,
          0.00664068, 0.0177833 , 0.01478692, 0.05205183, 0.00312327,
          0.01162422, 0.02005435, 0.00612514, 0.01390916, 0.00476527,
          0.00148602, 0.05653984, 0.01319662, 0.02024864, 0.03948217,
          0.00418122, 0.00386113, 0.00414321, 0.00934003, 0.0038707 ,
          0.00598852, 0.0113607 , 0.00731944, 0.00842111, 0.00231779,
          0.017056  , 0.0083878 , 0.0185283 , 0.01912571, 0.01261327,
          0.00277874, 0.00692684, 0.01007667, 0.00620935, 0.08732183,
          0.03225263, 0.00751303, 0.00128669, 0.00309086, 0.08788548,
          0.00411089, 0.02296314, 0.00582971, 0.04981115, 0.00137301,
          0.01194179, 0.00674903, 0.01060908, 0.02715535, 0.00552975,
          0.00659749, 0.00920752, 0.00803642, 0.00514145, 0.01203318,
          0.00101397, 0.0113605 , 0.05453257, 0.00282009, 0.00767004,
          0.02502173, 0.03705399, 0.00943853, 0.05232201, 0.02556035,
          0.02998744, 0.00661054, 0.01174951, 0.02180223, 0.00774098,
          0.00365738, 0.00661001, 0.00393221, 0.02133125, 0.01984226,
          0.00421506, 0.00902136, 0.00465617, 0.00277018, 0.00720716,
          0.00537063, 0.00239907, 0.00433557, 0.02399821, 0.01040917,
          0.03875955, 0.05427978, 0.0138095 , 0.00129527, 0.00153976,
          0.01478625, 0.01908657, 0.00518173, 0.00047245, 0.01402875,
          0.0112537 , 0.04991324, 0.0075018 , 0.01117975, 0.00282085,
          0.01326511, 0.01308442, 0.00316964, 0.01959633, 0.00749636,
          0.00482717, 0.00312731, 0.00532258, 0.00846428, 0.00573355,
          0.02887618, 0.01386253, 0.01058622, 0.01561545, 0.0877464 ,
          0.01434364, 0.00949981, 0.03778178, 0.0194213 , 0.01243207,
          0.02978747, 0.0200015 , 0.0255887 , 0.01154436, 0.00512063,
          0.00280211, 0.01357084, 0.01959268, 0.0364804 , 0.0146501 ,
          0.25561138, 0.01314971, 0.00376637, 0.01438709, 0.00291359,
          0.00884711, 0.00405993, 0.00473278, 0.03838452, 0.00486382,
          0.0801954 , 0.00368687, 0.01423903, 0.00790684, 0.0022771 ,
          0.00106624, 0.04699432, 0.0006971 , 0.02060373, 0.01208924,
          0.01981319, 0.00781818, 0.0190869 , 0.00124503, 0.02156658,
          0.0351937 , 0.01902522, 0.00528445, 0.01422389, 0.00487519]
      end
    end


    class Normal < TestDataset
      def initialize(size, loc = 37.4, scale = 1.0)
        @rng = Distribution::Normal.rng(loc, scale)

        super(size)
      end

      def populate
        size.times.map { @rng.call }
      end
    end

    class Bimodal < TestDataset
      def initialize
        super(1000)
      end

      def populate
        [17.265652730984268, 16.63330532833835, 16.03847326359458, -2.0942551258627633, -5.227526915172062, -4.930217193006796, -6.024885646974033, 0.7167286596626239, -6.591910842749648, 16.929772228575438, -3.236759611513121, 0.6928205847443865, -2.017103630911332, -1.5835853032048641, 16.140439812456393, -2.401250449059929, 18.34951631734132, -1.9321772344887023, -7.0085649217971095, 1.0408013959527498, -1.6064077911139258, -1.0438768420522992, 13.738116861941862, 17.20275725070663, -5.087775996671384, -3.6249909347817533, 0.8022746928324409, -5.8526207424410694, 16.455665695851707, 15.839417292493168, 16.74078202869773, 16.37400586209809, 17.459063454352947, 0.42160981644323714, 17.066754955365244, 17.611856389239193, -6.147380584297777, 17.769821821756132, -0.9480345222557576, -0.5590622079387413, 19.77185017791745, -6.437137980684227, 16.36012665521995, 0.07537376204981738, -0.9625087631392417, 16.699193895405912, 16.723390651622214, 15.41057823336171, -1.1008294641411214, 0.5332162758823191, -3.385740606351204, 2.6165416361961, -3.499700564300392, -4.081368455384784, 17.32814804811153, 18.729948492831436, 18.16176400283694, -2.89092215411577, 2.4412035139583477, 18.71826743480948, -5.0958828373928, -3.200697543905724, 0.9741422513066604, -2.5253419313481604, -1.9650645718018696, 1.840891955888948, 0.865995912269693, -2.4507644889871227, 18.860889937223813, 17.90791287349467, -4.486357492104857, -1.4278129640652257, 0.5506314954187417, -4.169591432746663, -3.3343879068432347, -4.073433833201632, -1.0599707793779305, -3.6600341486626413, 1.625026353055394, -1.053731671072515, 15.17922399877793, 16.403634382725183, 17.422664487431334, -0.19685747826897382, 17.708390466491682, -3.205783439352969, 16.352548411628767, 17.87724107461389, 18.64925722747322, 17.346497000329343, -1.9245108495401408, 20.117341353384568, -2.84101938117497, 18.173860911570124, -0.4491309230316063, 17.84296362939171, 1.107426461340081, -3.7692802770415033, 16.929776486231322, -1.4778710236401962, 17.24878527667532, -0.10310524685234301, -2.153362570934226, -3.788727538975301, 3.2769443751793315, 2.1229754042189795, 0.7472332232962451, 14.331548266772334, -3.5974695972393396, -6.916189403455663, -1.406705647091485, 16.977917561127793, 17.30360359168669, 17.312313016047064, 16.764250550687894, -1.0741978708589892, -1.1118629796353878, 19.587811505752217, -3.0394790297019982, 18.302517240031687, 17.204981590815635, 17.010533319727067, -1.7471724918682692, 14.261749638495495, 15.774743936935131, 18.53530881051973, 16.27868727935621, 0.2940660727433957, -1.4408615399560198, 1.7705401919409782, -5.589116874102014, 17.744377472607205, 14.776734838130384, -3.937564836176305, 18.574872959208964, 17.345646964588592, 17.328974659442967, 0.5287289688606647, 18.89543330120187, 16.922478474244517, 18.468824170488865, -6.61741188016268, 17.836033195582228, 17.58757961280531, 18.442140926671545, 18.96579648656132, 16.737557875771884, 15.32722587229438, -1.879305809911184, 16.169260213132276, 17.245620233834202, -4.83627946330282, -1.64146560753981, 20.025045944116194, -0.4377827647997896, 17.283214595920775, 17.898192456123738, 2.58521259918457, 17.720317015618935, -1.026885611421354, -0.5924165744192784, 17.386663109342077, 17.083281924647366, 13.738071681371114, 0.19851540908403997, 17.85540424272462, -6.112760255264677, 2.052526004310593, 16.84200748509294, -4.531749478925543, 16.68789788306591, 15.831420118904767, 15.246339848607311, -0.8026829679790672, 4.288273769628534, -0.9117606302197976, 15.996936681751762, 16.889386343321135, -4.722123938126047, 0.3517149766536307, -0.6488380241999341, 17.208297833797776, -3.9262403633512624, -2.953469407827667, -1.9732535535467088, -1.7077435619576704, 12.434657548124132, 0.024856293135605334, 15.324146880395453, 17.94199179419511, 20.1775503389754, 16.668668562006392, 18.505717844656683, 1.067198046765677, 16.930298752855432, 17.734717314670625, 18.5170083530855, 17.798273200859978, 0.16732849237500602, -1.170816338295214, 16.240819259332593, 17.61928575709638, 16.48463298106988, 17.312130218256147, -4.224060109922025, -5.790962455400372, 17.680464520838115, -0.9717090795106347, -3.5145806702561533, 17.771112994747412, 18.307509196738817, 18.394210214966627, 19.381293538989663, 15.903399491970326, 17.353698452773745, 0.7618640236887946, -6.97898522623244, -0.24789309647357438, -3.424643304339769, 17.907929447501818, 17.56759064118611, 20.689830111687513, 17.56811831112957, -4.109707415558708, 17.60741691119223, 16.759722687490093, 18.009975433709304, -0.9641504934882488, 17.860958969321583, -7.0725303796081125, 0.7790701919571381, 18.26135271464147, 2.079158363259414, 19.327462673107494, 0.04180697987750559, 16.274841521547305, 17.502649141664524, 17.71456015033684, 16.34664197453354, -1.0943946370599298, 18.08130793036192, -3.1009253781392854, 20.430818813515284, -3.536308208220156, 0.4834169601380527, -1.9569352305895675, 17.97445507700663, 16.708539403749185, 17.950040752978502, 2.7884841165660053, 17.983437898622416, 2.13332225348129, 16.619157953162066, 17.125247425598264, -1.6435254547544194, 19.318386265333064, 17.425077255579748, 2.5995608131496653, 19.085654662403414, -3.8887463638194912, 18.347731739608793, 18.451033380819712, -8.659094871232702, 19.364162323749486, 19.31887883571281, -2.8052471599751687, 16.68484990584016, -3.6203062692340895, 14.825660402361175, -1.2895702999308676, 16.99315025788577, -3.82611669944259, -1.018375691210225, -1.6930681683102666, -4.356283239137712, -1.585014586509621, 16.196838419171897, 16.200654712490177, 16.229567301530835, -3.942819556508245, 18.346990571086593, -2.6382127642540105, 16.93744420012703, -2.3144682847163436, 4.34238884228313, 18.248126251947447, -6.205771944025912, 16.816731367310297, 1.3388324362724413, -3.996905584909312, -3.6614398170579316, 18.220725607576924, 18.47782351586068, 18.542156992119835, -2.8845832000256744, -0.8249226413368738, 17.44316443924389, -1.3132321946207948, 0.974602495644584, -6.338927738625039, -4.666439844635394, -1.8954659551205089, 11.117403852090096, 17.757602510642876, -2.139726985160442, -3.9452061763900863, -0.32705455894524604, -3.0098872102210823, -6.756528131786316, 16.59119565336874, -3.2802342406002443, 16.346461368319805, -5.5644759324980395, -6.675628801020536, 18.34573079393602, -6.982770365175046, -3.691708014553156, -5.530261178787093, -2.4876112909642685, 17.148904560717536, 17.59899666481009, -1.4579483420220734, -6.4929815040617935, -3.250438697665512, -2.82954750037794, 16.94612116558058, -3.4166915639151534, 18.243798632018205, 17.920282555457128, 19.76902915621459, 17.717520148729864, -2.6877900922591937, -5.110750664362573, -3.9136080750198188, 20.277343370790252, -2.1548725525334462, -3.641368350008876, 18.80963320359626, -0.5104711486422029, 18.96542275638353, -3.6368664274622446, 17.382606125408124, -3.838058031933826, 0.15408546770603682, 17.41421166531414, 18.485653119474716, 15.812191242277457, 17.281869306756153, 17.61431022815667, 2.7470467234932947, -1.0343112063876483, 1.030219166979288, 18.411355441121547, 4.657102998836049, -1.8463829697321632, -1.4440176413045416, -1.771796365507813, 17.047883400023153, 18.581170320342267, -2.3443497379593454, 14.817930664650397, 18.927970799250314, -2.473233791406546, 17.809250306354546, -2.2550748441451196, 19.686488144193003, -0.6529979409663258, -4.646603487161033, 1.0956498035781745, -2.8183165213886934, -6.059586109736816, 13.620001714140411, 18.783266560624345, -8.765750166621208, 2.5138676622242997, 15.891620926301059, -2.595505168899703, 16.115429486601062, -3.006883400610925, 20.1924013008324, 16.897259453733, 17.986769864181014, -3.4385463423532157, -10.97444943375311, -3.7257167433089404, -1.2037574548165224, 16.259670462611886, -2.04012770854394, 18.154543919059055, -1.0765936888596686, 0.10228233742041182, -1.4646716531464739, -3.6556490939306308, 17.97261747998146, 17.486963361338645, 0.11485737474287783, 0.14755115095350346, -0.4340675683191251, 18.158370822886432, 19.692549206079484, 16.93090382341301, 18.237218978766872, 13.58604836846032, -6.60305673458629, -2.4727452424623517, 15.683909424558198, 18.165820656489327, 17.143013668485473, -1.389444379606237, 16.89012559715971, -7.008123306195094, 18.674784246897314, -0.7044339576199554, 18.021986728492326, -1.7155500095557321, 5.1681607102165925, 16.111950369758066, 3.931567938004661, 18.863683986105013, 17.049063578734312, 17.193937554107947, -3.1775470461008517, 17.409409694175093, 17.74346028010407, -0.5701672776996594, 1.2886712187002924, -2.0053334633284496, 17.411706154645373, 18.382124521123902, -4.286954867887786, 1.2539010392515042, -2.893963427611165, -2.773129311271478, 17.814967513197768, 17.815927108326147, -2.953686827099724, 0.3785221234551175, 11.401488968639036, -1.227594269698687, 17.473550158579723, 16.771568554920343, -1.9287755509964515, 0.27609152143223614, -1.3594829145533471, -4.6112848268435265, 17.52798946976184, 17.359608426240637, -1.3043175280074621, -2.726781192442013, 17.35933086294134, 0.35320135728237956, -8.577271106807355, -3.269370420061967, 17.361969796961723, 17.706794485584656, -5.82695593547266, 14.765313737987078, 18.649887322765277, -3.662638301488067, -2.8246226284303875, 16.61401991902875, -6.300366786241678, 17.29952037943806, 15.190670370425941, 16.695676685438613, 16.036334212403016, 2.3829296105806073, 12.100907612598903, -4.340475139513768, 17.102585242786745, 17.80226877291438, 17.40110761139122, 17.665623467940595, 18.714409994695398, -1.6413221407639706, 16.91945997132938, 17.636795311875552, 17.297237539796043, 18.876209187020752, 15.251923858366148, 19.33320968165669, -4.300091958786794, -1.3464105736668128, 20.06029959492314, -3.5567063612641854, -3.755658568402029, -1.517450908145507, 4.2721108523656, -0.5789439535069478, 14.484807555114202, -6.562545558508697, -0.36349441891338774, 16.98168022225121, 19.69998385438853, -2.257300427574596, -5.417631879060325, 17.330623382190947, -0.8967764202565482, 18.94049772241739, -1.5973585718387304, 16.78136668221579, 15.384237324713995, -3.1892969547038934, -1.5704883430980898, 20.27519808797855, 17.326711435253436, -4.401270024095081, 17.132671512911667, -2.172612346214041, -0.5582745512767324, 17.913615713168184, -2.424868879689809, -0.19867843530097762, 15.204608992836334, -1.0286121534022137, -2.4482888908453946, -0.9171449220536085, 17.02017743125495, -1.502146894588508, 16.8570933078186, 17.204323091102975, 1.0052147146587131, -1.3056948546302678, -4.9533691720873145, 17.421501076839775, 21.437765585871183, -5.122665320292194, 18.224764381150198, 17.82316875704381, 17.050463710125054, 3.8446429362855765, 1.9468683430249953, 15.773916122575772, -2.510187697752121, -2.3518888146789387, 17.014406988366563, 15.744515450954703, 17.565685797584607, 17.7991882733269, 4.28416966024245, -3.649242715947992, -1.2644754291976095, 18.211117779742914, 2.440467894546253, 17.06079428161632, -3.05047314562714, -6.766412800376274, 18.294627659131326, 16.550079238987504, -5.27206222585408, 0.32225923231969267, -3.2191089301292775, -2.8021859833099914, 0.9085638422444156, 0.16069863183269728, 18.7837310192355, 16.16798765284919, 17.4980198589872, 17.388648482704006, 15.86711907652738, -2.8276222380216893, 17.680205609986306, 17.298530549504648, -3.2547684347690615, -2.0810789720858667, 17.520817537793395, 16.287790050529253, 16.875865304278538, 17.39602769025573, 3.669258526348198, 17.71064821612437, 0.79146886031603, -5.8223434560112395, 17.57505333303369, 17.802094145280897, 16.94080119499258, -4.933361628996854, 18.749891978742266, 1.9197051523882713, -3.7190993502278706, 16.747689786608767, 16.227825666038793, 17.60219721785853, 16.737561800960226, -0.9602289920906366, -1.2532795692625303, 1.8134635108584982, 2.98943468111729, 16.59942911375263, -1.580613280021122, -4.821013692049165, 18.191753349652817, -0.12256286313967135, 16.637332010748548, -1.8595126385323928, 16.72879172431146, 17.939719839610742, 17.663275828971074, -5.159000377999338, -2.263043176765383, -4.3733393260396145, 16.790688233565522, 16.998883816731954, -2.7749572006829077, -1.5056553597929279, -5.253702517375839, -5.48447681116976, -2.459591723426199, 18.188812155336603, -0.0394375110498677, 0.5084105328748381, 18.08655606707613, 16.76915663842849, -4.497870729952495, 1.8519923617850655, 18.68309431082451, -0.49949125270563544, 15.650414975912994, 18.685135471775556, 1.0313438045302536, 16.94693016928052, 16.972336790379398, 1.0368619818783795, 17.427916474397065, 16.686145474111125, 16.890763970675792, -1.7697446822104146, 14.35764150924206, -1.7593523813505771, 0.004356349085824718, 17.07921720098881, 16.713411062689364, 17.4065837255689, 18.951356239766444, 16.19868464070491, 1.002517388981555, -2.9270262390349204, -0.67866335116613, 0.44535563308630266, 17.311125360152534, -4.306381138594702, 3.070707322084682, 17.121604809871318, 16.924573636837586, 18.48944241291219, 17.91579693687665, 16.970947035814522, 16.903008789634686, -2.629858804036194, 18.262758392460988, -1.5176286312280014, -2.3442472316274245, -1.565339335061328, 17.711325339988793, 19.1332634717399, -6.039193678609195, -1.8950845146914188, -0.7985728669476744, 16.059452943396995, 18.299869325560984, 17.99488650744871, 18.17474155539924, 17.3639751074932, -7.540733652772885, 18.120938873620208, 1.1922303586977052, 16.879613293716748, 17.968484331813585, 1.3400486323120986, 18.003259954615665, 18.107404099800295, 16.740565106725025, -5.8354626853667195, 13.786109491559023, 14.67256141290093, 16.149060350459955, 17.200136826625553, -5.727785903647547, 15.208146412187972, 0.4925627141930389, 18.689592646716847, -6.157518436371704, 16.36798337293891, -2.1005760928140313, 18.008212326744307, 18.941773751162412, 16.822101244249783, 17.024850453579806, -1.1928584809593026, 15.494057857808176, 0.1568049614874263, 13.664196114799681, -8.957906586452225, 19.859417879476837, -2.1207824174173804, 16.37738755749202, 3.0685181389573595, -0.4186460120615427, 17.192300422439697, 16.701238733970587, -3.5649621758437204, 17.16874828453926, 17.1525597542266, -1.9031713758147275, -0.6251211538753054, 17.906789358753052, 5.056320293944724, 17.57110207802224, -7.370630523264073, 13.690889158816468, 17.384762937373186, 16.162825602640787, -4.622714351150504, 17.058726484881646, 13.35304919878396, -2.5157596999931466, -1.7455041444176458, -3.287522717564291, 17.054956373086693, -2.6767801006747023, 16.98156835307172, -3.452154936229518, 15.866261223213188, -3.2282313642414895, -0.9915971396457306, 16.440099766674535, 1.323783239635186, 18.316020390350307, -1.7139113269042332, 16.952195493845778, 16.526649219573397, -1.2254827584818337, -0.9586406613588572, -4.2590747541889495, 4.168402317094149, -0.025761519944609512, 17.646452599812598, 18.28378304842505, 0.18892285952233534, 17.37845642834967, -1.7910419013709022, 17.153998079519294, 1.3462442990909862, 0.9265620713159031, 14.8118880199065, 19.614470680963734, -4.6673669012519055, -1.1158026279551878, -0.2621088074858422, 16.645323626450434, -1.819007412161565, -3.8232610655166406, 2.021589955602918, -3.7226451316081004, -0.7813395788099358, 15.424299403390723, 16.92330923064296, -4.265556741947683, -0.1328265721896884, 0.4576686566803123, 15.701092032778558, 16.60143773427041, 17.280157723683217, 17.56583912019882, 18.22598317799134, 18.070837281287936, 1.1029297293334759, -2.8900392089430533, 1.2108804429960909, 17.838181494055917, 16.703826029331324, -2.6276944141019984, -0.3149426933879762, 16.4046972646741, -3.1701039663604753, -6.055484828936699, 16.640532788557756, 17.472267876163954, 17.469521941509964, -1.0493709587476434, -7.233585019996738, 16.779058791827676, 17.254891837815723, 16.821175793076947, 13.32538803467467, 0.7909358296789875, -0.020341162864917717, 22.26838017454176, -3.8175774395208633, -1.2220892665772847, 17.433534554205394, 20.12008577414846, -1.208480121650073, 17.250266184141964, -3.9040659905661386, -9.772094910197517, 16.915829650765723, -6.756377211426461, -1.852761240776627, 0.9857418998588443, 13.706040755832145, 4.804489261811023, 0.8464284861331901, -1.854398002799138, 16.962787836866998, -2.562888990782279, -1.4548617648242557, 17.35163751216573, 0.17710389684181038, 20.195685716863842, 18.190391289667566, 15.914159568883885, 18.034743986423752, 17.359278203957924, 17.35073819790274, 0.10333027548158036, 0.2353631777047971, 17.871540597277416, 17.245666553158866, 1.355004522135152, 17.037403155366405, -3.843337992477462, -2.225100795212058, 1.0474276563652323, 0.845921397678497, -6.242788900591409, 0.00852150656978612, 16.67420533354886, -0.7162622865844483, 17.400638675871733, 14.05125511670606, 0.8833612843102432, -2.773482037843122, -3.4754035925044917, -0.12235204899572016, -1.1245596954343298, -3.259582048125487, 16.58701987986457, 0.04867956322131395, -1.854060145492129, 16.22290784917065, 17.65215006315461, -2.834820462518447, 0.1252206579210533, 15.060287652291645, -3.2772454016941266, -5.037229884826658, 16.52657035195571, -6.311416671743693, 17.69110538892129, -4.761435786330254, -1.2157579792990472, -3.8280429121724695, 17.193402085836755, -5.312071758893957, 16.95685158675704, 17.360411912970584, 18.102248984797537, 17.829993755024073, -1.1573941203423763, 19.103772536635738, 17.310092449405555, 17.617656414683182, 0.34465161623436336, 2.5685752556007317, -6.322272359765348, 17.197197766472105, 15.784963501356254, -4.69688886041544, -3.9264724305420313, 2.5412926227427235, 14.313240743526654, -0.49251636519881625, -5.619414935948219, 18.0737242303998, 17.7101485547681, 19.230468519985173, -4.267358801137733, -7.457468411496876, -6.536411431809614, 17.50326127561346, 18.25860191039946, 19.085203399877777, -2.3792260644720926, 18.614288792052246, 15.916548252731086, 18.997463375656384, 0.900519392515791, 16.463806853380408, -1.3054406402203762, 17.687093752155988, 15.360700415759611, -0.16826034032466763, -3.492549433953289, -4.942698213071978, -4.000470698379021, -3.2683590442078048, 17.145159682852025, 17.514144979540855, -1.741017002357677, -4.820678176929352, -0.9743261434042683, 18.88439918572273, -4.518650594761105, 0.22253017226151828, 16.890489152212492, -1.625861346783061, 17.491993990810755, -2.606165380536047, 18.732073820869502, -2.5805841142689996, 1.265992736128497, 17.541748184929464, -3.9040740427770446, 16.675850288903398, -0.9992478417227737, 0.22021814644774107, -3.2369331045444034, 16.570591545626545, 2.1732418683226724, 17.629599015437368, 15.448886984162069, 0.14881725695519377, -2.3044527034010445, -2.896138054287693, 16.231646414496748, 17.53333955291074, 15.86780003727789, -6.247941321561732, 17.149667458655408, -0.8712759910841501, 0.3580043229334855, 18.256802206143156, 20.09910703074305, 0.1920334564885824, 3.1253134350346405, 2.9298430416910257, -4.0072684421748725, 0.2655035101771732, -4.175650289608405, 17.409833747266532, -4.931696886058427, 17.73222908422741, -9.11743324691237, 16.414147539706963, 16.05216549609657, -3.4529045978476116, -6.556983676062741, 17.973315642722618, 18.446314395831983, 16.776505386125642, 17.497059434725557, -5.584513282401161, -4.913503512838823, 16.165498322121945, 3.5973162004353654, 17.846865372415422, -5.547095657556346, -3.4959605807145477, -3.31289414108984, -4.933675195353784, -4.279389623817821, -0.966046938185656, -9.268237082499116, -6.0654710980666025, 14.82120264981589, -10.795591995593426, 17.152318661846266, 21.85044401173972, 15.558464454275844, 18.2580509546559, 17.506176117179876, 18.47702263297393, 0.6501175258665497, -0.08283107941381451, 3.2800079893192997, 2.060914011246174, 17.206200176538022, 16.45715707306718, 17.420019491145624, 17.55494788143961, -0.9395416950152846, 16.874675044998362, 17.56967524920756, 0.8636709130532907, -4.790431073576565, 18.47174395268243, 15.193016194636645, 17.65549751632438, 17.887252411457037, 17.705905727553965, -3.931077007487433, -4.726588426506137, -4.680753781614073, -2.800714367148849, 16.576863491772787, 4.620836531250873, -2.2767823844091635, 20.501192700014112, 16.574635126774986]
      end
    end


    class Mixed < TestDataset
      def initialize
        super(1000)
      end

      def populate
        [0.10099272723865271, 0.13596703344393987, 0.08544972388261164, 0.08892881993232558, 0.10339494873054236, 0.06713270307207315, 0.07931598612532634, 0.09525407920949902, 0.09728426907342644, 0.0825205845536517, 0.15545302574616043, 0.10943889048506049, 0.07292075501638706, 0.0976002323223493, 0.07064640840759943, 10.648337897814857, 10.19010787155357, 0.12000613318692151, 0.1303925751954757, 0.07903566302820604, 0.11652530126217493, 0.07052014678539896, 0.08320769251512396, 0.07509259986441778, 0.08703399291904007, 0.12012134856901698, 0.07707363394856627, 0.08419395837514212, 0.07673907621190074, 0.10192848118939546, 0.07341680810580778, 0.08298210133382841, 0.13021843040972914, 0.13195146633814125, 0.10334157003324403, 0.09457008851849062, 0.10673755257562463, 0.10122946098233435, 0.13252984306227983, 9.466678125902304, 0.12307654742564839, 10.563587907174552, 0.13587049592911268, 0.0904738531937237, 0.14910578107567454, 0.11582105869178544, 0.10642464739896532, 0.10823777692475584, 0.0717584369242807, 0.08388333103794954, 0.08848799770069489, 0.12951530017262375, 10.585546800275841, 0.13883154460346978, 0.09502349505295263, 0.10987127771462615, 0.10766999848131607, 0.09738572288513182, 9.749309276614518, 0.07626227984037257, 0.08878449514784556, 0.09117567884867228, 0.09235851169111443, 0.11450060341443509, 0.10852729403984247, 9.261932973441079, 0.1437542564457961, 9.597795735975055, 0.08181623552553857, 0.09790355643770919, 0.08230082057976681, 0.11028590270028477, 0.11080782304343802, 0.05279778918911542, 0.0792658055487647, 0.10938315024282644, 0.07238462563847192, 0.09905939511911299, 10.038652703687404, 0.08694419387678451, 10.94284489953505, 0.1250050946854236, 0.16213218477728955, 0.13401463871781052, 0.09389891602518964, 0.09371973844347398, 0.11201167916013754, 0.08522026068123877, 0.09929537537588734, 0.15516585483730116, 0.13065005322952003, 0.0873527656989389, 0.09330796734670171, 0.09139858197193962, 9.735714467791489, 0.09115873684058666, 0.1027898500774009, 0.13229916694267801, 0.07455793604079423, 0.12386510015591917, 0.09739717155649935, 0.08625611447831061, 0.0747889579231398, 0.09997876573064049, 0.08301362939852926, 0.12794434827236725, 0.13807235332418388, 0.0964662945568087, 0.09750799700107811, 0.16333817464207634, 10.152586342103865, 0.12400512440775556, 0.08302343380699667, 0.15574307213217062, 0.11979902644622918, 0.06986440171637746, 0.11788692855168581, 0.09302507378826969, 0.13035857204591558, 0.08341052580584292, 0.08043754681189746, 0.07645108484086321, 10.020561615850468, 0.07185353307284102, 0.09137327845814025, 0.09714010554806936, 0.12182288194813579, 0.10012184336758506, 10.095611466636905, 0.1300149914029989, 0.09977583277338682, 0.08918825497521518, 0.10689406312918706, 0.13148735457244573, 0.09471689954290315, 0.12406348989847452, 0.0950768876048121, 0.12056449591453751, 0.07968853999228744, 10.140831632661461, 0.0886883622778943, 10.504019220747562, 0.12947997044235035, 0.13228466808749345, 0.07253574864952765, 0.10284700279966097, 0.09549440456641128, 0.09185709068924672, 0.11738528950657223, 0.07914482524246956, 0.06600004891686646, 9.641429131775912, 0.07225698534092427, 0.13269076348661654, 0.13169515866584866, 0.06061391911204755, 0.08105522923305719, 0.09667633050613757, 0.1527948955192776, 11.22012707958613, 0.083278690993486, 0.09634449257343664, 0.12017086659026942, 0.1719209883516668, 0.11486241471132315, 0.12003164715231177, 0.11540304230613226, 0.09514634091532691, 10.146545409845933, 0.12447865874949263, 0.09382985928928413, 0.07930380042897958, 0.07962397680404122, 0.09586288135259023, 0.11409540801224048, 0.11728877406271154, 0.1595409476822696, 0.08750650437517415, 0.09034835788025515, 0.10213807429770932, 0.0729111484800202, 9.809020273580751, 0.08943346092532387, 0.09099350675151796, 11.202530395516261, 10.632543851198614, 0.0831127438255805, 0.08286190360928614, 0.09620922125619553, 0.1974805820239035, 0.09151361358657707, 0.12334135870795358, 0.08484666784053999, 0.09690080345604184, 0.14305072073525357, 0.10195068192353632, 0.10057690863830467, 0.11512609293932159, 0.09315280161086348, 9.947264519580958, 11.028820342903884, 0.06772874047428165, 0.08319875800776326, 0.11094928744223408, 0.11731699766360003, 0.09777853608947618, 0.1950547444055735, 0.09730005424490354, 0.10949195012883713, 0.18661076765500784, 0.05609640677219237, 0.12725522320717872, 0.09216844752031517, 0.12912993203900694, 0.11816243939569888, 0.1148851355215401, 0.08250921614831741, 0.08953957767041706, 0.11501156182858428, 0.10262700965540372, 0.12038150015907174, 0.1323088646655834, 0.09450443514971957, 0.11660345112568023, 0.07528601237659018, 0.08364550415681431, 0.09375676315396977, 0.04240142973524388, 0.08375512637876374, 0.13232118666513276, 0.11233072404620584, 0.12918346020057486, 0.13473548671006394, 0.0830247532906089, 0.09421757337225589, 0.14760816972514645, 0.11265390704559884, 0.10870419681540161, 0.14564095605182512, 0.09210428406772536, 0.17188519432346172, 0.1326432748420404, 0.1551223691163734, 0.14523393726769027, 0.13051511089982634, 0.09622058946705811, 0.05379048162874184, 0.09741023801720038, 0.09583344189912163, 0.17596892460740768, 0.07528445407187301, 0.09113113623088878, 0.07840789257511005, 0.0828819236038769, 0.08035342564721742, 0.12803989787678838, 0.11058236378020268, 9.564356590562697, 0.13140710145701903, 0.061955679157165745, 0.08625007558736544, 9.64971979645562, 0.11191628544457506, 10.446236428850986, 10.981663970759888, 9.531520432847158, 0.09997499673632826, 0.10812697753453732, 0.07933894445431955, 0.09764793887171014, 0.13779188716864746, 0.09494752619920513, 0.15900199218419386, 0.10389045708104455, 0.1236645551793097, 0.07401031561437252, 0.1806377951686909, 10.697439250151419, 0.09186687775991531, 0.1192393273901335, 0.09672066678415442, 0.14744052227876417, 0.06457424860189584, 0.07281081850191388, 9.629722971783075, 0.12000281277117056, 0.1344150393277214, 0.09857160618561284, 0.10018610880642498, 0.07989414049907682, 9.933756714531519, 0.09754669128729221, 10.093240419962028, 0.05874190799409961, 0.13670869500394153, 0.07921674303399896, 0.12234096779061475, 0.09461893577065979, 0.10852055404590183, 0.1326171237547446, 0.1462061892561006, 0.11140875041952872, 0.1137886175072137, 0.09951737943414457, 0.08572729151835602, 0.10977320888219351, 0.07433337974493871, 0.12521764043759945, 0.0996544146900234, 0.21739100619428747, 0.09467507814815135, 0.09123180796976914, 0.1064533403507622, 0.08903999485726899, 0.09838724377115117, 0.1175720623131436, 0.0709831554361758, 0.1285385511202032, 0.06512321487939159, 0.13189417253036065, 0.09822578874672833, 0.07089400610383995, 9.853983273353911, 8.954739429274552, 0.1273555427842173, 0.07467308598334305, 0.14578221787028564, 0.0731655245185389, 0.14582163399478534, 0.12132769965502915, 0.0651017476655157, 0.15232415313764042, 0.10078947900719362, 0.06300785210284884, 0.08541947418492907, 0.10020747326068924, 0.11360938683534856, 0.08251093192433956, 0.10091843509542636, 0.0881236833086461, 10.036691980853021, 0.08097767862013172, 0.08473010456840371, 0.0691833348083189, 0.08873946590080667, 0.0757826511410445, 0.09369112284570372, 0.08291432335318907, 0.12357030890747266, 0.10440719924792248, 0.14828114529563485, 0.08617202270632057, 0.09793559890429061, 0.13072046801517823, 0.06775753506503505, 0.0799073112520442, 0.0721525185897333, 0.07547632428261741, 0.09699159622681745, 0.12978769895975487, 0.06781345999208403, 0.15555924738686536, 9.951440912389005, 0.12044665499915526, 0.08259584457789011, 10.056331620880522, 9.341628457099178, 0.1325096383572286, 0.11956039217699521, 0.10118012988434338, 0.07700793689736778, 0.07325354263410565, 0.1508608797937555, 0.13705886605272818, 11.110453430866956, 10.215811344837855, 0.14852048707914423, 0.08692551423449583, 0.09573400444508007, 0.12584942658039122, 0.10471345300651405, 0.0928001085510824, 0.09342127310138415, 0.21258133256545278, 0.10853370362235021, 0.1136986925071571, 0.1105989079395488, 10.539340668408778, 0.12232097315539825, 0.0864607749547037, 0.09567385272134322, 0.09002580944220334, 0.07610552423491294, 0.10848882078212929, 0.06911720483364413, 0.09482062090932038, 0.07948939552860984, 10.205055173174452, 0.0911760301737145, 0.10019223720744926, 0.104366988765697, 0.07771838652091914, 0.10521987276002631, 0.092053994795579, 9.577307210031467, 0.06680648579773152, 0.15326704154845527, 0.0739371678777931, 10.55306440352576, 0.07992998513027771, 0.10635486564980806, 0.08676373145797957, 0.1054508672627291, 0.11251226272614319, 0.08298569899388854, 0.11302990308721511, 0.13694593722544576, 0.1108149938771455, 0.07420298339565375, 0.12813359366649063, 0.0731547179132002, 0.07822309330023214, 0.13182155346550026, 0.1426385731928239, 9.760363949052255, 10.001986207012145, 0.09831641706004979, 0.08115940595710466, 10.10587337376367, 0.17881653472972275, 0.09650975119836691, 0.12847879513884267, 0.1713545610807754, 0.14361571053084848, 0.08721558774880987, 0.15304294275741412, 10.284126397274077, 0.09488531740286954, 0.1135155664359612, 11.044821981040407, 0.06949972813782802, 0.08214802385349479, 0.09571848572766817, 10.128485219808624, 0.12003907317100733, 0.057959281209485375, 0.14301507935120125, 10.1390675398608, 0.10953715755591072, 0.09070885202195804, 10.245811122461705, 0.12834391634153075, 0.08948601010669349, 9.927777430859239, 0.11110859847614354, 0.11917492390653761, 0.06413283698266624, 0.11288149421313465, 0.0656108952132424, 0.09766279579122195, 0.1500059875641501, 9.77951971780248, 0.11198401125761102, 0.12424083280153245, 0.09734201638925431, 0.11437518566380361, 0.12737024964055296, 0.0716603121129911, 0.09873789611489824, 10.868573973107393, 0.07938269293888828, 0.07860796111546646, 0.07497543733487588, 0.07515071677615953, 0.11333864358918687, 0.07959200920294081, 0.10352706460892949, 0.149894075588215, 0.08426484121289636, 0.07656677586188756, 0.13931498898040726, 0.05958545161466369, 0.09855212259080995, 0.07131577268775029, 0.08497275675083434, 0.14074885824886402, 0.12812077125439858, 10.13589981152848, 0.1187848648033274, 0.10910053079493227, 0.133520302169047, 0.09624225762667159, 0.10953612494982466, 0.1367052116073308, 0.14102606510009408, 9.33217627160689, 0.0707291668941959, 0.09013904008457008, 0.07393875904848181, 0.09553470990308333, 0.14041603240356393, 0.06293088664477545, 0.09572313867447353, 0.10265585900420866, 0.0872423709046084, 0.11318986791073433, 0.1562092994207911, 0.09560317894248599, 0.1001273456718058, 0.0788153483920599, 0.1090607385553491, 0.1310246022957249, 0.14395265260294798, 0.11667052807671006, 0.06554002285227147, 0.06881351980477197, 0.110223123401401, 0.12956510237101643, 9.402981045642461, 0.05474945919083433, 0.08991658093427568, 0.06512950412968625, 10.400522404185853, 0.12136733796056823, 8.834757842950745, 9.776017895950707, 0.14412330225557243, 0.07237268230711975, 0.11209238020316022, 0.13032015244437029, 9.076746187204643, 0.14664910550142324, 0.1135424636567785, 10.781147120353378, 9.921672209460851, 0.06795479582090794, 0.09886555386926182, 0.12324686528339997, 0.10814853996256929, 0.08033665213429553, 0.12304481787815676, 0.11780108842539656, 0.10807146144144449, 0.06800440922047644, 0.14129154564943616, 0.10637862408696055, 0.1207443738654732, 0.1467288977524118, 0.08005941107419112, 0.0987622999559562, 0.09804536838441646, 0.07846793098500354, 0.11225582019352512, 0.06346074721554788, 0.07889846820852747, 0.07806560545361593, 0.08896773356244382, 0.12198371911507772, 0.12441819211004142, 0.097050587076971, 10.167635459762492, 0.1604258734009728, 0.1466075947408145, 0.10719146176514266, 0.14033100781520777, 0.09043080326864872, 0.07629805034920614, 0.10808131468796017, 0.09343585752528322, 0.1031016669704959, 0.07816704875831211, 0.10953516670360577, 0.12262969099070847, 0.08880341364688589, 0.11233363714007383, 0.08128275192623768, 0.13485546687881675, 0.09533999332141396, 0.09149347254790687, 0.08890014534955272, 0.10437021742673601, 0.05590015533850881, 0.07710790223447754, 0.08035245602707647, 0.08140166986983555, 0.09001604724007287, 0.07529096915681208, 0.10869442375498234, 0.10476960943742895, 9.354520431467876, 0.07170346502292443, 0.10485303202603313, 0.09877874479418411, 0.15938661289695324, 0.09038780872422686, 0.11377189374908235, 0.08890243707990887, 0.13074352978548295, 10.726770052604797, 0.08325649611456609, 0.12828758432164292, 0.13278517790043448, 0.05141584896973547, 9.75376092389246, 0.10495693766472527, 0.08254921780716024, 0.11194133602872425, 0.08407421751610511, 0.1046602265831898, 0.08724040262802005, 0.11672490124701862, 0.10367449355543082, 0.1073692958694819, 0.1464064028117694, 9.498210572185211, 0.13608966811762369, 0.10825101499590191, 0.13024751325628114, 0.12568397459677635, 10.22721353502296, 0.0911694279434283, 0.05710636995039922, 0.0741318216600534, 0.1127543925223955, 0.11029486088670798, 0.09344085066932589, 0.09378007957333051, 0.1372775365100286, 0.07022969295060019, 0.09002109360132952, 0.07936453847474662, 0.07390885921245313, 0.15817230107748992, 0.1223329473069277, 0.09051393061114617, 0.06793707229304, 9.879099766197813, 0.08796955781436437, 0.07747128664413158, 0.12320999404759517, 10.406169891917209, 0.1250870914605475, 10.235483207581161, 0.09316682921621555, 0.13096750879515007, 0.06981562208782455, 0.1611582106560947, 0.09596314295218458, 0.10099129420650066, 0.07639276346443499, 0.08309427949901037, 0.09726709622210575, 0.08688613737100874, 0.09518604736487908, 0.11886741307344598, 8.989854237865877, 9.482924601979, 0.10011277079908071, 0.09262994234386579, 0.11270726627305615, 0.09109284940368256, 0.10223491957207419, 0.1053118725011662, 10.50649120536693, 0.11136201143798229, 0.141247637075888, 0.0855835843092649, 0.1386598560116629, 0.08336744850239552, 0.09878239125537004, 0.12811649506143383, 0.13553238113478547, 0.11596104189860593, 0.10866749360993422, 0.08164447035108634, 0.14450391829136502, 0.13096628891190829, 0.11184800869671813, 0.08086768857696758, 10.04516272648106, 0.10038601907886394, 0.1354266977428047, 0.11038724091605928, 0.09534335808013612, 0.1375113746898975, 10.349478072115028, 0.10043499996297811, 10.66858192333955, 0.13714351235649141, 0.06279935415784003, 10.168173863098986, 0.1356895762834147, 0.09404186929576601, 0.0847735004143064, 0.08777511378765214, 9.32029284136666, 0.09106083557733544, 0.09290069739217903, 0.09678140273378771, 0.0938242044498094, 0.11147599134167836, 0.08408474432309004, 0.07415075525787425, 0.07108718463707545, 0.08418599314538538, 0.06924894345745207, 0.07023106810864484, 0.09445652262584232, 0.08440664542070841, 0.09348788190212391, 0.0933944208721294, 0.1003996054653653, 0.06578900823099058, 0.06271152201041204, 0.10310126527390912, 10.118701081532112, 0.11216519464138573, 0.08806441862590408, 0.08057509280353986, 0.08252217122175595, 0.08187414926405295, 0.11527583670579494, 0.1022402483214306, 0.13522729063348649, 0.1117978326292005, 0.13032920774135537, 9.074016379969127, 0.12323023732503757, 0.08241064058665919, 0.14199922189907288, 9.724229935742036, 0.09052752488851319, 0.10131935485782757, 0.11067573203084496, 0.1276942223146927, 0.0848464000905936, 0.13224529430702223, 0.071778200938653, 0.1021762269210558, 0.12353778346545126, 0.08716089225025436, 0.08541483510425676, 0.0920797227998923, 0.11870354108048915, 0.09388010147471486, 0.07959542730606645, 0.07369809814759262, 0.08546463578339328, 0.1372385523764848, 0.09813446747797455, 0.07545847420612517, 0.08371309906527628, 0.1638967050077092, 0.06419214977696779, 0.15905541605577428, 0.09732202267856505, 0.14872166513221305, 0.1251152513141733, 0.08599883723497581, 10.24460694645521, 10.056638702905627, 0.12014878810845393, 0.14791082978431136, 0.06897105150889538, 0.13443226974562855, 0.1055161381826256, 0.07338934542848671, 0.07304652826556382, 0.10573806815377747, 0.08623034949666358, 10.321063308107233, 0.12550930156103757, 9.740121016603677, 0.08862845612948045, 0.08938147872644348, 0.1495555945278054, 0.09732190155616106, 0.05860057968312643, 0.09603339540921867, 0.07498904401704364, 0.06389503282793756, 0.2533918215926499, 0.0724247451538336, 0.11200158888864234, 0.12955377628022063, 0.10412045888844922, 0.065697357903563, 0.07500863687750342, 0.07478849841554809, 0.1023700788442886, 0.11757404148350292, 0.09373208895211982, 9.926935272929548, 0.1032334629575721, 0.09119933363313304, 0.07658984955490622, 10.844734486243372, 0.117924269158077, 0.10001014867704512, 0.11013302909995637, 0.10503631497203546, 9.903365998780087, 0.11588994744859125, 0.10402593639927218, 9.679510498685403, 0.1222607485193064, 0.06743877701282923, 0.10864510806154078, 0.09856597289343974, 0.09861521573066777, 0.08010595940165849, 0.07051880844873686, 0.10910273774771251, 0.08900379733447256, 0.04121247750410401, 0.08748086041632853, 0.10449139713824827, 10.005840678907001, 0.057196238916775846, 0.08414373935648145, 0.09289106444903175, 0.1495287283047657, 0.1403302435251385, 0.1005050866095209, 9.127975604972871, 0.07742097485707866, 0.1914328825144319, 0.08191663367417049, 0.11114602408235162, 0.1291930727891495, 0.08409387544963226, 0.07498045241066453, 0.09835819741536349, 0.1183747378042772, 0.07956345031204057, 0.09064692106279942, 0.1157734116417196, 0.1024902895880524, 0.09611746626046573, 0.12647340337016952, 0.08549970507940163, 10.763794141252943, 0.09787379455538765, 0.0788010954859755, 0.09604133840638866, 0.10553503652713658, 0.09759933982181301, 10.602039706409167, 10.026893547436687, 0.06626608362584628, 0.08679752028188037, 0.11115715201042363, 10.365959314139086, 0.15159317685133575, 0.0796986253993146, 0.10525802270565053, 0.0857633827905604, 0.11969675761564064, 0.0937655768092821, 0.06965499842540347, 0.15228772453341088, 0.06976754842559545, 10.729571800700302, 0.08909412902126451, 9.610276573062489, 0.09298494813271654, 0.1103063490075599, 9.906662169810625, 0.11564259244687257, 0.10210303889824357, 0.11626900362076709, 0.0821298800594731, 9.714709005936657, 10.550900705596163, 0.1110917264262761, 0.08249788364535225, 10.22478396125711, 0.06552201203250037, 0.07206014442781859, 0.07762839079002892, 0.07117718947782824, 0.10692309447622071, 0.11311798221427012, 0.05983219635656617, 0.10238835346077102, 0.09910853915337897, 0.07848486940723354, 0.07233066142060215, 0.08684454589041599, 0.09893735515351837, 0.09240078101202355, 0.08372496583942321, 0.0885651050052983, 0.08420492662182033, 0.10169628300987398, 0.1341027769011673, 0.07488945504949904, 0.056731193489721755, 0.1205363121248581, 0.11324858489894618, 9.84368281072627, 10.601109204511987, 0.1032657150966959, 0.12002492411794544, 0.07811704095807648, 0.10715421705609203, 0.12905633969188376, 0.07528860915176121, 0.11092156630433392, 0.12778652002233773, 0.07702006501027397, 0.11523471604775398, 0.10192462901498806, 0.0774743143549165, 0.09143175714929516, 0.18522190629481983, 0.1701681662211243, 0.054488671562861184, 0.11527321966490028, 0.07313754342843341, 0.06507816397330334, 0.09016492069109261, 0.07663031101607792, 0.13502666011561754, 0.0940038689591512, 9.986843897375865, 0.117261335683298, 0.11052978041664707, 0.15264373229725003, 0.1389529423720147, 0.10789830706305792, 0.061025893697939954, 0.08636685861083274, 0.10906362813091063, 0.10901062109467022, 0.13312708350319546, 0.07129120768590809, 0.10311106237511142, 0.09693086266666098, 0.08817180493597777, 0.07321618697222769, 0.09165897597959598, 0.13175269766592673, 0.16266961863671367, 0.07901790937306684, 0.1385144023748108, 0.09354382019691486, 0.10444714763593169, 0.13582178793254004, 0.10365132418777573, 0.1383735523786908, 0.15653730276235167, 0.12082209618506984, 0.11205601063169413, 0.12274905429033514, 0.12674195591191204, 0.08631770522222754, 0.09706999553673899, 0.09644816571327125, 0.12299029406761142, 9.954131302470284, 9.585435778456313, 0.11143008474757173, 0.06715521064054746, 0.12339699340391196, 0.09905742796208694, 0.1138499099539637, 0.055880039150142835, 0.07531209168501782, 0.09059720116194214, 0.11051623975923885, 0.10042176620005516, 0.10189151148353422, 0.14852208992682878, 0.0853804405530123, 0.1205292907525301, 0.11185919523497218, 0.08978971283839654, 0.06572822893998369, 0.10977891474511758, 9.045418236588946, 0.08312502148681257, 10.2353691631789, 0.08644514101129545, 0.10828985827792315, 0.13362936347177723, 0.07661394966160423, 0.0917578467527281, 0.11543558032319493, 0.13802028592397952, 9.608972147343987, 0.13978075622770555, 0.09634327893451901, 0.06081137347920719, 0.07701947030980433, 0.10988817645668869, 0.08262938825298649, 0.08875894375880966, 0.11397056255275227, 0.11160204550614378]
      end
    end

    class Trimodal < TestDataset
      def initialize
        super(1000)
      end

      def populate
        [15.644195981360705, 17.368107197491476, 5.242843595044977, 5.17763519953114, 16.13668333991126, 4.750271137676436, 14.068240661467641, 4.249353862818147, 4.718229461886723, 17.426205560666514, 16.16691408270878, 14.285617944644603, 5.0293530306043746, 17.9427033308558, 15.097661299103633, 5.181976691564451, 0.027069518144620802, 17.60466646445155, 4.88947962281526, 17.37016841015675, 0.004416517525410385, 5.504565118233493, 4.379474528325165, 4.987881674696619, 4.585895360770676, 4.675519978969515, 0.009821853741324892, 3.5377417300633054, 17.262733871482286, 17.46887015926203, 4.964175434149593, 4.499654659087934, 4.768909818916951, 4.570009153271116, 4.52758599113503, 17.78981830732425, 13.990411429048034, 0.006217833517635762, 5.530753699043112, 4.994072688537662, 5.692265235063535, 4.498101302389382, 18.554978545567366, 0.028359779648753677, 0.01152438376212339, 17.772376734032008, 5.332234814780721, 5.230711044062373, 20.82585400253679, 5.430813657862983, 4.8551829319983275, 5.037339490812509, 4.427055031945654, 0.0035558203763329096, 5.032877494517447, 5.678063777974426, 5.094903905032117, 0.0029348592885226816, 19.07994278600332, 4.47545684903656, 0.0017444525077172299, 19.196104676707137, 0.00194073494328811, 0.0016667186239555476, 0.0014339060873307325, 16.248115947125143, 5.517888105291103, 5.088521880043563, 0.018746870881529067, 4.990990951945656, 19.20447334821512, 0.01884903614468093, 17.48045582865589, 4.415399976624139, 5.059609666500968, 5.934452943396179, 5.01531512015003, 0.010839995774182754, 15.134132634532099, 5.342234964187271, 5.029086237866808, 18.634127094275886, 5.251661075967728, 18.00640052064646, 17.472496335313334, 5.229982395109367, 17.0827652780877, 0.0008299133427255882, 0.0018415095967128092, 0.0044591731634901636, 0.005523984743000792, 16.650606631383738, 0.052924386189866744, 21.19444790904773, 5.100132682218469, 5.0691348091269015, 18.141958662550383, 0.0034790246729381807, 0.0038631258921757393, 0.01534616626211387, 18.99600192155045, 19.575850814351945, 0.0019213515225309755, 17.071257999744198, 6.237894846925931, 5.210402216139219, 0.016367134397845498, 18.321084466025574, 4.8297174560527605, 17.26040034985617, 0.006765812790999243, 0.01772695423308503, 15.580571165165452, 5.8777418944982305, 5.223583540861269, 5.5851567138581695, 16.82174044255309, 5.039837032140947, 4.941177499226672, 5.071531112017269, 0.012100133672352431, 15.338480721671148, 5.362408899990459, 4.928350029088115, 19.663405997053218, 5.321780151309711, 6.0455556401864605, 16.207164647083456, 17.46170964658027, 5.122285731796794, 0.0021771750223314947, 4.501536799083, 16.638681753206008, 4.885786034003312, 0.0007510036229791043, 17.454017652571277, 0.0003856071246690717, 5.4705940677624305, 5.714051120986433, 18.347650454982983, 5.562495235613601, 4.975220802453874, 17.06015712365982, 4.998289035316301, 4.666421062692018, 4.459550315661415, 5.648927290275099, 5.712299807060136, 17.30343817955885, 4.564609155131003, 4.9610380337530575, 0.0004119828555008822, 5.656194231654608, 5.438263754202308, 5.241659856109833, 18.559813110391968, 0.00037866997446203796, 0.0063925043083080816, 0.00821020474531626, 5.47842168822538, 0.032446672501986726, 0.0004601962170818673, 5.440060473871741, 0.002206433749048081, 17.858583247118712, 4.451615079294875, 17.189732821268876, 0.0012411681120982954, 0.009159762901500071, 0.012912429792222797, 5.344894293021173, 0.0020558434425979374, 5.81328245710006, 5.088482630539888, 5.610375437591987, 0.013832894845314012, 0.0020589555750685417, 4.680824565164285, 5.289743554399524, 0.002756332503904598, 6.330070380437443, 0.0036940583568661344, 17.185036022305766, 5.7324088841243235, 4.699950981352598, 4.886378390869834, 0.007172197557086715, 5.25316546389529, 4.371403193996187, 4.767870948860717, 17.329397967989404, 5.025575731301711, 0.0024792531933617006, 4.900446219809138, 5.333377957197517, 4.884343870606202, 13.09180273052308, 5.42526210851912, 5.388948831849508, 4.133745859872782, 16.325936711716107, 16.0251901775681, 0.0025867384314866046, 5.099645308347185, 16.82034217721489, 5.656886571784272, 17.137069484764126, 16.957321347308387, 4.605645373269598, 4.925774908955942, 5.278999493618567, 18.85950044381817, 17.459446352328193, 0.005449017217158259, 5.875416880110963, 4.723573130547798, 4.682066030547268, 5.777081526829672, 5.174985255967208, 17.263156811606848, 0.025565635204236506, 0.027295693578628853, 5.413931349193001, 16.869759548775207, 5.7357632762690915, 18.295364660608847, 5.409880993552257, 15.353981449250384, 5.510735182727886, 0.026549748521312085, 16.94751121138251, 16.719017589392003, 18.077816030161813, 19.440708971469356, 5.0788768331400975, 5.233648291393131, 17.232874808384782, 17.85387223640997, 0.006597253944239916, 17.37571041909801, 4.780601377648684, 0.008248465003191255, 17.140612864445238, 0.003051034088986475, 5.59549736857524, 5.152806101796145, 14.160411782952565, 4.639854789923073, 5.3213262208246865, 17.645539592248603, 6.050442716337144, 4.594701543904785, 17.3068456098361, 0.0017471954297217857, 4.823290693559204, 4.721325914294728, 0.003708671359659988, 17.39927728888776, 0.0031410377285323553, 18.633157627427654, 17.65987336902493, 4.756141698269638, 17.519011678318027, 15.51099434603788, 17.00223221740978, 0.0062461419716732395, 17.710659785018034, 17.460868244638526, 16.351890906869983, 16.913618348164263, 4.879754439311833, 17.288379105613387, 0.0033879672308550534, 5.691250129579291, 0.006210391677945185, 4.715028373365351, 5.266594580290543, 4.5950363288446505, 4.841998558148784, 16.37036442371785, 4.1860225111974705, 0.009232413380765973, 3.8500692646139116, 20.72486043900841, 5.3342778572237295, 0.02158390517426369, 6.052271692125274, 0.00287763838795416, 4.049912667284547, 4.180937276122528, 4.158051500401922, 17.553164990808376, 0.03378669250842154, 17.1315218899424, 16.638036635764866, 3.6455332107223373, 5.463531824162418, 4.690507884660183, 0.00211390680969743, 17.421941441735637, 4.386511805843412, 4.9043868192982165, 0.000321901582551265, 0.007842941651455793, 17.883846007614434, 4.280448272227325, 4.666732214877715, 17.435906352973056, 5.928435754540097, 5.15981983638353, 0.004510595523190465, 5.951880065525828, 4.886565861250103, 4.3690150058706685, 0.005152737054181983, 4.769156006812677, 16.896460130301357, 16.863506138718652, 0.03559772913934183, 5.746222940203187, 4.669756671587807, 4.905689318042643, 0.019863374556734627, 5.224068683443523, 0.018724212016011266, 13.75892477149096, 17.41163267333975, 5.106423809716324, 15.879291814589756, 5.152559477189769, 15.945516085402698, 17.92058761176097, 16.802726792163913, 5.64262634323362, 4.579193396658104, 17.55784917228315, 4.925287111215071, 4.2277434721036, 4.836126113826002, 5.37194594724843, 0.014616301656593134, 17.802659492626585, 4.975516550299642, 18.752325527327454, 17.07243625983038, 18.101667958357904, 0.011327164085292695, 18.895986429602395, 4.38174164676342, 5.345056011872006, 16.833777620989405, 17.094724811307213, 17.020896876911713, 17.680682777743886, 17.065480363058178, 4.700939432542438, 4.677882320422033, 16.13416995316766, 0.019989728774349073, 5.68031685785313, 16.569938791646862, 12.336424450624296, 17.239098467215523, 5.645815298318415, 17.51897130768293, 17.95194372478149, 17.684119811679448, 15.98494324998943, 0.008781830058578211, 4.876728182678768, 16.962486784389757, 15.310424894761828, 5.085882529155957, 18.707034696427957, 4.734932753662578, 5.343445367461683, 17.6626498311735, 4.830411364747184, 0.009723123843612787, 0.016354273129052504, 17.66454080021822, 17.131944458368984, 17.510280219682368, 18.214014969974944, 23.35941873933668, 4.6611829835295175, 0.012980326569747003, 12.777117316359822, 0.0014651806922679038, 17.802220870079168, 4.377809720478382, 4.746547168188861, 4.830296118752394, 17.029270691716874, 4.843463217556766, 0.021684550848833285, 19.76850271413186, 16.61436437924822, 17.716547066293877, 5.206755815908378, 4.503952588893254, 5.506621355903441, 14.615210266082554, 0.0004858791792148818, 4.917556841649492, 0.026518593121899012, 18.317083788392832, 4.904793533121426, 15.938039884340537, 4.379836084576801, 5.07324026599916, 5.9218369201440115, 4.634108777257391, 15.768612396620693, 15.249203041832814, 0.0038504665162269664, 16.927728661384613, 4.699632157960933, 15.334572170548467, 5.752833014707902, 5.376412155705523, 6.297690315132352, 15.830878955131656, 4.16055738768905, 5.371129934248947, 5.021525889364026, 0.007249507759349064, 19.28169368620148, 4.44427019876303, 0.010293569604679524, 4.540925910007524, 17.684009089976318, 4.8789503017593585, 4.579029904477526, 0.037020164983257386, 17.3116932869134, 5.342082585953395, 4.955506271377075, 17.273462858055726, 5.250575240836349, 4.594631408058218, 0.001560957430129949, 3.948474685955711, 17.189499796451475, 4.179520378454834, 15.83597882700214, 17.21699006051983, 17.433452027063836, 4.664905521470315, 4.456002106305085, 5.495696859121156, 4.84836014809504, 0.026490475279774404, 4.808271192506867, 17.643065791513976, 0.007646897209520758, 6.3906439209400805, 5.359006305279619, 0.00024055208597893916, 5.512919271284535, 17.43282179149578, 5.389467429227612, 5.9330185143217005, 5.42819390115873, 0.03385783841146625, 0.01637015268808278, 19.28880286631978, 5.167018478789777, 5.5669611890366015, 17.84051394125056, 4.9179916466404485, 18.52952097448975, 0.02590062661951606, 4.035001203213336, 20.342287786827857, 0.009414053259452502, 16.655408850036586, 0.010300603217865538, 18.16435016479992, 4.863717883639355, 0.0016749204887311065, 0.02497840150117531, 5.035091421104326, 0.0020936409128500424, 13.903024544867765, 17.44903482074133, 5.47495587609429, 17.25555647780643, 5.051458187677988, 0.005245975334761402, 16.480765907874293, 17.34433414436825, 0.0033273317972262123, 16.467060819729742, 4.028161368029821, 5.671317232307755, 5.10058056309332, 17.157356366204702, 5.121429583065384, 4.867380970793121, 4.214415605479202, 4.561224106852788, 17.2668458562824, 16.92325950295767, 0.006468435695083489, 0.009402595332432843, 6.0057596846404175, 0.014663303940986314, 4.649697885499404, 4.982050893694712, 5.184898180012029, 15.994192609174378, 5.295019536979759, 5.173349120679906, 0.0022690257203286357, 0.004204169971372011, 17.17162991868537, 0.0031639194148863556, 4.8761726937704495, 0.0025433371494200173, 0.0011532826099360206, 0.03946038928256619, 4.337852651360644, 5.687923421389376, 17.2910398616437, 5.47395705921702, 0.014799624217154344, 18.33375587519751, 0.010583732155356962, 5.14971036632579, 16.329691572129132, 3.836461407987054, 4.3778253847007935, 17.127440243612927, 4.798641622072469, 15.477108253067591, 5.226705123775251, 0.0035075998146656953, 5.82772983012274, 3.6516737566986937, 17.09326140281692, 5.7901912850975545, 5.12402497067003, 0.001002062315022945, 4.783069773076388, 0.0025854644705778844, 5.254718146705233, 4.605389157493104, 5.1688348978314576, 4.255464911679859, 4.937774041743229, 16.665856603173907, 17.39674793804067, 4.884898999998612, 5.660595554497848, 0.015357560436570121, 17.33759336177664, 5.427861775514119, 0.005037609197124407, 0.004706320973739957, 4.1994732290296986, 0.002008397140373924, 5.472461117920277, 5.122583788167304, 0.0184075121692007, 5.776701955259512, 4.092157974915258, 20.796105661502583, 4.749908400466793, 17.26777114022408, 0.043207592039226916, 17.032103829551858, 4.701724840620042, 5.2717199794934375, 0.011328584991160554, 5.569881942555675, 18.000234762152367, 5.302609133996685, 17.433962291189005, 5.018038228762744, 17.175006891540804, 18.173078896625032, 4.587607683245991, 17.670756692305435, 0.008424908973892708, 5.907677430882919, 16.624233175872035, 0.0011678236959186703, 5.340812130097208, 14.494793640358592, 5.673685144601446, 15.959196336602396, 4.779472755551556, 17.74029874456687, 5.9168380676894525, 5.595000960771426, 5.042991313786528, 0.0009153857865257052, 5.0541262349348015, 5.546041159424718, 4.766509921886956, 4.571728913331307, 5.466362648728468, 5.974699470750881, 0.0030714198504837582, 19.22256257625036, 5.267393154224477, 4.723028151506277, 0.005061915139675819, 18.19808727029573, 5.513780783847862, 4.766374896119477, 0.019339250552539603, 4.785644910588036, 17.21016138752819, 0.01430547795581037, 5.150452447813319, 0.003774568123402017, 15.420702324114739, 4.222294703360416, 4.72588085689392, 16.453058798766907, 17.413617140061135, 17.424303887631755, 16.96568767703505, 5.534225024342885, 18.50805496053278, 0.0021222287890942113, 17.43401578133999, 5.364623821544626, 16.304460465221535, 17.367327760704196, 17.33515325228922, 17.81545130391646, 0.00726295602388826, 0.002103584245653206, 0.003514149973253465, 0.0013056338643070704, 5.988770224870993, 4.8083622125653385, 4.495741365884181, 0.01401125315533374, 16.473083431689, 16.568511611474396, 18.216704224060635, 0.0037894051781806725, 5.050339817151846, 4.571517074323697, 18.584076900729116, 16.315801463657188, 5.019254870694807, 5.0815692255821, 17.72662902396465, 19.634999508997964, 0.008954585158248698, 17.31203336764604, 16.982076197810112, 4.795596219851411, 18.605600094883876, 5.630342311339008, 16.59938312066346, 5.637009632895876, 4.864220612446798, 0.020199342660664196, 0.002031552721757437, 16.109059997801864, 16.283201206123003, 4.511369111395805, 17.092681339520013, 17.837766710346948, 4.746873225679535, 4.675969341538843, 17.97115968297192, 15.56579516734708, 17.816183903751508, 0.02089320214293447, 4.967134891514163, 4.562054774032337, 5.018527469156921, 5.166435654661386, 22.158058150352065, 5.364886242477623, 4.921658076726847, 4.6506253562825135, 4.746986261383755, 17.192003020047146, 4.77498423555439, 4.574479444299186, 17.243635164480537, 17.737387562615442, 18.421616806578886, 5.193944194907294, 5.348565572988328, 4.328455273147577, 5.16311652708382, 5.062644768494474, 17.09463328464969, 5.662262543796127, 5.561987906227991, 16.895220974548486, 16.34724961896359, 15.301514575338237, 4.559969616377023, 0.004040001982854169, 16.837605778056847, 5.511158572688323, 0.0030437952782626093, 5.0734590596549, 14.872774447560841, 16.768839005212236, 0.010505341704805103, 0.010295611761239016, 16.023265971848712, 4.807262092247096, 17.401001850653127, 16.481604224973236, 4.566911496532375, 18.184212214374256, 18.935011478090924, 5.02127054320728, 4.89338351963569, 4.999124486320528, 5.177739871860824, 0.01860778162997008, 0.00041849142653649406, 6.074876798521184, 0.008339255697947823, 4.583868368873884, 4.280861988604581, 4.746551271090647, 16.937436217805022, 6.224788615678225, 5.225522259872853, 0.002560064910458293, 19.827028502577118, 0.0048078995883527546, 17.426476897417224, 17.014911411172143, 4.893281859541803, 4.9318297837437415, 5.103181402556909, 0.01686083939436595, 18.675515736631205, 5.819955165916513, 16.988793349521305, 16.862067441778443, 5.003571111541431, 19.25082031609078, 4.904861483644363, 5.020847870102383, 0.014327614860308908, 13.374784755278121, 4.468156040371414, 18.600536733164596, 4.610412190329464, 4.572891308490551, 17.770005435332504, 16.611360818744433, 5.169701238586471, 16.895658635914998, 18.406310191126057, 5.716925973709422, 5.119009866727841, 17.692859922967266, 4.86980937874129, 15.93247684545613, 15.964088959981577, 0.012428769140532495, 5.471172283577962, 5.81624917035106, 4.569431745461409, 5.589606444693114, 16.49425159089845, 13.570396907433494, 17.06488894850015, 17.828320611793888, 17.29737199326221, 5.127776354931159, 5.096563161428997, 0.008944348502491806, 4.780299912647213, 5.064582909823034, 0.009210033619029325, 4.401060048848091, 5.031970214974657, 5.1842528313804825, 4.787683193206908, 16.517831139634303, 0.0007578278609478828, 4.901101348137398, 15.959047967140245, 19.09209880556777, 18.978676790772155, 4.481036505383416, 5.806805223310701, 17.053298964895667, 0.0006562388547158557, 19.826245428457558, 14.443964121154726, 5.516301324291198, 6.0994215286755376, 16.875008722454314, 0.008409514741831148, 0.003669392066413587, 0.0068678601855612035, 4.965927860587305, 5.0931212377384085, 5.452755655873904, 3.9913824534463727, 5.763514821694014, 0.02124171559710816, 16.203964359889724, 4.32023667660077, 4.435241334040374, 4.572573463943089, 4.830769294041431, 6.116668838524158, 0.0058701272622244125, 16.396232501768598, 17.675039028931906, 0.0016742342027213995, 4.7992163790020355, 0.006142287730820637, 5.719934691774584, 16.73859422477984, 5.381446659467906, 0.0028753770597091145, 5.033975859739494, 5.124002922592165, 17.779801294790442, 16.949573189008788, 4.320266681873753, 0.00018999430500172765, 5.846693432611177, 5.318098628411725, 0.002230357718770161, 4.347549362422545, 4.977906927724647, 5.6993034648642755, 5.055666792326356, 4.143178624311093, 6.05253875033879, 18.32152770930556, 5.4424707646487205, 15.887470087712869, 16.30437351394032, 4.782227234140446, 17.01479370356165, 4.331472062664342, 0.017574300790383603, 5.103163762453928, 17.496038637833333, 0.01768042700295531, 18.869539678236624, 0.05872540499044433, 0.010432705440247783, 0.013761152930821492, 15.99318964929724, 4.78096203369704, 5.182478003880751, 4.816551484424533, 17.65027936322445, 5.363510851329358, 5.400013577692459, 16.133200142986254, 0.0029342193277354894, 4.834630035156524, 4.369274893250908, 0.001548099856690813, 18.234152820697854, 5.890075259198083, 5.172014316771721, 5.472409290600099, 4.686589222019545, 4.694144852669344, 5.531672160912259, 0.009213063936802475, 0.005457382633911405, 5.019107087025776, 5.302484270690491, 4.4223797765521216, 17.234719827745746, 5.380891795779902, 17.408465363106224, 17.38216582201798, 14.661390187522061, 5.026041920062017, 17.284997025002735, 4.627722061581396, 0.00026669820564568483, 0.002282011452969457, 5.67516083857515, 4.491066943626116, 17.037718791594976, 4.317052080965056, 0.0033894666113529317, 4.9209971912550525, 0.003415735776764596, 0.008302137206793023, 17.17296176432816, 4.9586670903246075, 5.413871883136608, 0.003638323379747097, 20.395727678414076, 17.9849132691995, 14.253594925777117, 0.0002654468037059159, 4.9245327465435995, 5.044457748355263, 5.157514556035387, 0.0014250580944035406, 13.496312519819742, 4.341307674698374, 6.006122177262322, 17.525347419315576, 4.950847493655482, 15.870078547658146, 17.839459826302406, 5.352072099037515, 5.183773457710065, 3.6599638220842, 15.494720977839775, 16.95960603838811, 5.945737394114043, 5.4177842964081835, 5.550274033920268, 4.702029221850232, 18.47289881363702, 5.190482019180131, 4.541836464380839, 5.492196650912907, 16.19164972624122, 0.0009355033288800016, 5.0935290025245274, 4.060843077059376, 0.008260826975167737, 0.003442457983165739, 19.663634549317095, 18.13772008113119, 4.4318297038424594, 18.88168236600803, 5.054758223023244, 17.245909998403107, 5.045680219815342, 5.058310575922285, 17.776377694339732, 5.160528441264902, 5.000889306833755, 19.15275512552428, 4.8210588106413494, 19.91682388530652, 18.325115534447068, 17.57784145461338, 22.301733929647483, 5.119595571792353, 4.77646687975034, 16.445484491431706, 18.84904058962151, 15.986378717512483, 5.115267075349593, 4.83563610926441, 0.001293451483243056, 15.801774707792928, 4.772513453868325, 19.419029308628232, 5.131691040736159, 4.736695784216917, 0.05393324805383693, 0.0061687350591266964, 4.502805460020903, 17.341182015655303, 5.535524215724167, 0.00575349081917962, 4.974476564917534, 4.563170143383081, 14.728810252039281, 18.038050070585243, 5.294162904061217, 0.0005973647408711145, 0.002155349095122975, 0.01365628162129937, 5.2854691476299145, 16.552891028444012, 0.002133969803388386, 4.342936205700457, 15.782212304266078, 17.392779720134868, 19.54141155956672, 16.09884804487591, 0.022622285106660926, 4.371237858548884, 3.9938964175315594, 4.661574583217518, 19.210977624480325, 5.346631758333631, 0.005838601374661348, 0.009208457658675739, 17.34434472553846, 18.049132281785198, 17.72973803915574]
      end
    end

    class Laplace < TestDataset
      def initialize
        super(1000)
      end

      def populate
        [11048.25516627, 11326.99895195, 11111.26137741, 11242.80457566,
          11328.06457291, 11320.274769  , 11281.95878613, 11214.43072384,
          11252.18688541, 11351.94938769, 11459.35197369, 11335.27334509,
          11208.90697961, 11362.49274394, 11199.8262732 , 11331.17983151,
          11318.34977525, 11140.96314067, 11266.74539139, 11264.91955841,
          11341.85610143, 11347.92120329, 11307.94719731, 11816.22578128,
          11561.41983203, 11292.71151125, 11280.00316614, 11444.24672524,
          11245.61486939, 11315.11937065, 11426.67285594, 11188.21622762,
          11260.29786967, 11174.24004768, 11215.10445842, 11277.87721782,
          11266.56640275, 11184.50440705, 11353.79438144, 11134.34585823,
          11284.78764173, 11245.35985732, 11296.58776851, 11322.00135258,
          11386.30479194, 10872.91660794, 11336.54292374, 11659.85127163,
          10879.31982947, 11277.74327408, 11249.78070959, 11206.12540423,
          11328.51925179, 11359.80924386, 11372.22396361, 11137.35424361,
          11246.90592563, 11294.78761335, 11401.49910287, 11381.59588344,
          11609.33529949, 11320.95106986, 11169.7557371 , 11246.86456445,
          11237.24201672, 11210.57556392, 11074.95789327, 11175.99223532,
          11224.89932369, 11222.49642064, 11214.82931425, 11293.42032482,
          11283.44292348, 11332.76039112, 11079.94533641, 11263.06305795,
          11293.64744842, 11003.31309588, 11084.71111568, 11302.1909362 ,
          11373.57942957, 11271.79388541, 11214.30618264, 11138.69801341,
          11281.60684973, 11096.82451528, 11381.6373787 , 11214.26852015,
          11297.73405739, 11230.29487897, 11285.82511096, 11237.05725772,
          11148.60071338, 11295.94052504, 11374.50540351, 11251.28467967,
          11205.58164806, 11432.15163369, 11118.29598682, 11273.35093465,
          11225.33445739, 11216.14376276, 11305.36003875, 11312.3792823 ,
          11214.19682108, 11411.47749794, 11260.29881762, 11209.90457812,
          11168.67554253, 11269.64013217, 11195.28075649, 11102.88885324,
          11155.91371904, 11215.65973693, 11134.58651309, 11288.01172217,
          11299.15419   , 11285.45139094, 11334.04391589, 11326.95050361,
          11271.49398869, 11154.39238268, 11297.86364967, 11267.83486221,
          11449.89225358, 11356.52737328, 11315.50394613, 11164.6434751 ,
          11196.64239612, 11223.45886841, 11219.87176475, 11197.74557003,
          11083.66612868, 11228.86745521, 11368.36174578, 11289.32328078,
          11871.04499296, 11177.13114507, 11194.76214142, 11278.92923178,
          11542.09954661, 11269.42414744, 11300.94138595, 11346.44228629,
          11280.59237329, 11450.7334983 , 11291.49761501, 11250.72426342,
          11061.05566262, 11260.93077737, 11304.1936979 , 11345.05613893,
          11317.78641418, 11418.05662101, 11349.787735  , 11270.58025102,
          11299.90505082, 11280.27852835, 11331.86617514, 11246.78145091,
          11306.90002961, 11194.13520351, 11289.30885784, 11193.67429378,
          11326.84096916, 11499.3074676 , 11321.14472525, 11275.94095527,
          11264.86072144, 11358.49147894, 11207.72544286, 11137.87336561,
          11201.38360215, 11303.13947756, 11369.76199755, 11242.61591753,
          11229.53143346, 11202.497828  , 11262.2521221 , 11407.23670874,
          11292.6349824 , 11247.3914248 , 11302.90813124, 11180.55550067,
          11447.05073255, 11328.83454411, 11210.26250353, 11243.67166981,
          11154.19378536, 11310.28033507, 11168.81100187, 11386.28391412,
          10844.50868054, 11233.40834137, 11207.29766211, 11344.20527802,
          11311.8390883 , 11088.08460217, 11222.96660601, 11481.75798719,
          11283.66341356, 11249.0565542 , 11293.35245531, 11222.61394136,
          11203.85114961, 11187.53968669, 11160.87045674, 11229.52980655,
          11096.70703145, 11210.71908671, 11339.96299011, 11024.97983013,
          11193.92928253, 11098.9843038 , 11399.79895165, 11272.14857064,
          11278.5318948 , 11301.59449291, 11285.38640765, 11265.79517941,
          11211.68990734, 11243.05147722, 11292.06448391, 11197.37916097,
          11228.12996497, 11193.28693173, 11229.32686841, 11270.12857168,
          11196.87506484, 11255.68885855, 11417.98181658, 11305.95879513,
          11218.9836675 , 11126.30475291, 11317.9020559 , 11363.4229273 ,
          11235.33680936, 11364.49332611, 11319.78319713, 11235.55976756,
          11364.67896157, 11248.1008902 , 11348.91295847, 11229.33306873,
          11054.31100402, 11294.87536392, 11240.52757618, 11278.69823444,
          11125.08635835, 11141.05350847, 11213.01745021, 11234.98518276,
          11359.65076006, 11382.82764104, 11434.64098627, 11331.75046866,
          11145.45353827, 11351.16435204, 11071.25077572, 11252.21831563,
          11198.81245104, 11213.15073054, 11339.90807653, 11176.49019366,
          11237.18630081, 11356.29740048, 11275.81521604, 11495.28688443,
          11287.73395702, 11278.19023456, 11290.69471185, 11295.46694377,
          11115.58059838, 11349.62958728, 11158.48583594, 11221.37887251,
          11405.3956484 , 11222.37193453, 11032.99927175, 11571.88528926,
          11598.58661192, 11376.3735601 , 11155.3657336 , 11036.64967624,
          11517.68109479, 11105.08491395, 11327.7729175 , 11299.75294898,
          11215.66727787, 11257.36132139, 10936.01845934, 11430.20764979,
          11335.51459745, 11174.32745573, 11225.84485553, 11495.27333211,
          11386.70969477, 11255.83380555, 11091.32907759, 11215.75203935,
          11318.39179581, 11115.22671895, 11510.82407243, 11241.87921119,
          11334.75228581, 11131.78705976, 11569.9629563 , 11597.35533893,
          11466.53273657, 11281.963808  , 11400.45591723, 11526.0054125 ,
          11278.15908858, 11365.06270354, 11252.24955202, 11303.57023174,
          11205.38209456, 11447.18932944, 11319.70737592, 11276.34416264,
          11466.52240968, 11190.28066265, 11256.10048877, 11404.37539477,
          11071.5768414 , 11274.62341289, 11164.6144807 , 11173.7762472 ,
          11314.26223444, 11289.96181087, 11440.5609878 , 11205.38110908,
          11089.96200507, 11323.1451166 , 11238.43493156, 11606.5139392 ,
          11347.22406408, 11175.27751552, 11121.3456404 , 11370.6127052 ,
          11362.50405057, 11362.66330478, 11203.8671113 , 11516.03689378,
          11438.86909431, 11171.07556641, 11288.80628782, 11126.35729646,
          11379.33264031, 11491.77349685, 11244.20056677, 10821.14417366,
          11096.60019209, 11443.95382484, 11043.24223171, 11397.32458598,
          11241.60903094, 11193.93988836, 11317.03322296, 11169.26309319,
          11207.61877556, 11201.87166552, 11325.27149849, 11327.43652428,
          11268.73460902, 11148.90747525, 11238.84373199, 11278.97077691,
          11577.42565054, 11374.56513357, 11303.5279693 , 11188.84286213,
          11187.1970698 , 11241.59649439, 11250.67224186, 11346.38435023,
          11180.78031255, 11263.26213374, 11216.91376366, 11220.7193586 ,
          11395.95109242, 11380.74596044, 11408.8812528 , 11521.03357894,
          11314.85961833, 11393.42437106, 11250.14885179, 11240.7702173 ,
          11189.19997121, 11418.17623941, 11141.46112677, 11526.47571891,
          11078.24740758, 11252.58663721, 11099.2511679 , 11160.47060685,
          11471.34553989, 11389.49278292, 11395.51733287, 11216.17546383,
          11512.82597033, 11221.48045755, 11233.94646428, 11381.36784535,
          11561.43533359, 11574.80078923, 11501.53242726, 11031.91339525,
          11287.72513256, 11276.50558982, 11397.77697636, 11064.66153021,
          11109.28860142, 11266.77547525, 11310.73792043, 11244.26126152,
          11282.54109864, 10960.01600427, 11320.88768421, 11290.28727049,
          11261.3520582 , 11352.96004668, 11444.86914408, 11049.85962642,
          11282.24347044, 11205.28869958, 11303.58566073, 11257.85602268,
          11169.93825877, 11253.10986745, 11125.64323136, 11431.28984081,
          11258.19611262, 10960.2401648 , 11290.48727833, 11228.80355578,
          11238.4684192 , 11216.95734894, 11258.3385738 , 11118.82725251,
          11459.52963215, 11381.52957509, 11297.25780053, 11284.94032593,
          11277.44456226, 11079.92666436, 11278.77327774, 11006.7230819 ,
          11179.68257438, 11086.23915413, 11341.76307281, 11541.41702967,
          11375.05282912, 11430.17263701, 11328.80762478, 11375.20073419,
          11185.2657142 , 11365.5284157 , 11167.30684264, 11054.81862991,
          11332.62928677, 11227.47374784, 11304.55836909, 11368.06672027,
          11018.63879147, 11272.95001983, 11250.00462172, 11286.18975595,
          11233.7743356 , 11409.40856378, 11315.81014033, 10946.69535024,
          11292.28876861, 11286.47045414, 11224.49112337, 11124.54953884,
          11007.53215278, 11293.62564025, 11274.39636099, 11212.98362882,
          11260.15402778, 11455.86626028, 11298.4056911 , 11270.73843985,
          11219.02882257, 11238.29295887, 11283.9796265 , 11152.0241956 ,
          11207.43342779, 11154.86670895, 11267.43568638, 11298.23007864,
          11071.8538907 , 11233.53537126, 11251.94555324, 11517.22906317,
          11161.48518341, 11268.64129509, 11273.42240184, 11244.41175079,
          11195.15088568, 11120.23936927, 11260.53173623, 11478.44557957,
          11410.23670715, 11412.13375941, 11201.81339884, 11431.65223648,
          11255.80817187, 11349.09588088, 11241.89799015, 11221.91782041,
          11235.69352777, 11319.94890118, 11231.96783828, 11291.64531248,
          10984.15640287, 11355.07039453, 11266.73025365, 11077.57946351,
          11427.41647463, 11463.3692428 , 11510.17756025, 11726.57808635,
          11238.91779662, 11208.45264419, 11217.23648   , 11575.19060594,
          11236.63529514, 11199.11443898, 11288.75667368, 11466.32541635,
          11392.38286499, 11438.35256391, 11210.57108777, 11072.85972016,
          11344.74640312, 11244.62038317, 11257.98619076, 11269.6769039 ,
          11219.79225587, 11233.0161388 , 11345.98493168, 11410.99549196,
          11276.95186629, 11274.43037151, 11327.7623699 , 11318.30051755,
          11406.80544868, 11280.83053542, 11381.97374181, 11459.31236328,
          11596.18086183, 11263.59581937, 10779.38506987, 11334.57863163,
          11257.65857925, 11326.65484153, 11378.67982521, 10575.22887125,
          11140.45561435, 11401.82803501, 11180.62240473, 11268.51725487,
          11240.42468197, 11281.32180925, 11335.09163577, 11349.07323122,
          11599.82741317, 11054.68834366, 11097.42960137, 11230.19409125,
          10877.57424768, 11230.70725636, 11376.57911515, 11225.22411703,
          11273.75446315, 11148.09518694, 10979.49663604, 11155.51325823,
          11267.45993364, 11297.42891306, 11248.26023145, 11352.66895603,
          11241.56570124, 11253.13691762, 11380.11604143, 11274.82210188,
          11359.25981684, 11278.26011121, 11268.1157811 , 11225.88464112,
          11362.68988996, 11248.40623485, 11318.13868091, 11605.15083027,
          11306.75352044, 11186.14240266, 11185.33889136, 11379.40064213,
          11096.99346643, 11532.51144261, 10893.40763416, 11311.68289557,
          11302.93555197, 10720.0334565 , 11346.86306148, 10973.40562501,
          11357.37832521, 11310.73477489, 11598.97504807, 10882.87985957,
          10945.90030572, 11282.13363602, 11278.58541718, 11264.22443568,
          11417.38181387, 11148.16628881, 11280.16542814, 11335.77794129,
          11161.43920046, 11099.01359523, 11217.02030031, 11675.04938899,
          11394.95456404, 11173.95717318, 11291.79230221, 11141.55240968,
          11473.54732257, 11482.51186612, 11365.05568044, 11300.23738229,
          11299.52881345, 11367.21076828, 11577.88174846, 11041.92141305,
          11010.75521949, 11153.42771835, 11245.76766272, 11005.40329814,
          11274.65134509, 11244.69213474, 11136.34446849, 11031.81978212,
          11265.62701614, 11133.32283557, 11342.10348507, 11212.82018887,
          11325.68202882, 11315.63836868, 11156.44344641, 11163.01128776,
          11477.94726141, 11252.23521755, 11232.73396936, 11265.92844281,
          11292.65124283, 11085.2104628 , 11242.994008  , 11232.45354776,
          11196.12307955, 11234.96632674, 11331.90563051, 11180.6867746 ,
          11290.08881193, 11177.5902252 , 11064.85421516, 11502.88362606,
          11420.7784871 , 11369.37571486, 11306.84787723, 11280.04274932,
          11231.2961816 , 11225.31549871, 11143.55249396, 10829.07294321,
          11274.41569509, 11390.47678859, 11213.83027582, 11202.45263842,
          11288.80513888, 11318.20932011, 11321.728341  , 11363.20823372,
          11442.5391986 , 11072.06808711, 11064.2193058 , 11421.8705474 ,
          11263.9569661 , 11071.88967916, 11325.86698765, 11185.09922778,
          11205.24787463, 11239.61375722, 11322.31034915, 11197.0233694 ,
          11202.86832197, 11100.53757099, 11345.57698227, 11260.04034851,
          11305.23582153, 11278.43040554, 11212.15894566, 11361.16163027,
          11059.37325149, 11201.37093651, 11297.10872738, 11451.64346951,
          11052.37753989, 11289.45256884, 11272.55257557, 11055.96422409,
          11294.19647984, 11263.73807011, 11033.88061065, 11095.36622403,
          11237.06046065, 11315.84757861, 11178.59352038, 11338.37548199,
          10812.50625426, 11042.28730599, 11375.56414688, 11366.5427601 ,
          11324.56392327, 11357.93786502, 11362.11842392, 11284.18877939,
          11043.6564284 , 11072.95187897, 11449.29143264, 11352.81722276,
          11206.8972578 , 11163.92058311, 11269.73087658, 11321.53862769,
          11108.05612663, 11127.69437322, 11246.73295843, 11277.16571342,
          11299.84516692, 11312.62533126, 11392.21134612, 11301.5895098 ,
          11400.20590934, 11371.06156286, 10773.41380155, 11074.58474923,
          11554.00043638, 11241.22934337, 11581.58713255, 11353.00291453,
          11262.80400868, 11012.9367948 , 11066.9791846 , 11317.43244362,
          11169.57528147, 11314.42170254, 11659.74513555, 11620.98814584,
          11214.07442856, 11319.52053023, 11131.42728356, 11053.50253417,
          10864.2942381 , 11231.76174831, 11444.81707968, 11251.56671637,
          11269.07439033, 11293.36356913, 11281.02008118, 11399.93358381,
          11286.62110542, 11272.1490295 , 11219.93371418, 11869.00827666,
          11369.72991537, 11193.26185646, 11311.65939815, 11270.35730423,
          11240.65104082, 11319.96714059, 11319.64378549, 11312.06816744,
          11089.94165646, 11175.94214433, 11513.88539024, 11368.25728344,
          11355.69753491, 11633.73486123, 11308.04397401, 11105.22584366,
          11319.18845483, 11389.7118473 , 11277.84344867, 10754.04417092,
          11260.62764165, 11512.05463828, 11352.7418674 , 11281.03164065,
          11260.64173745, 11319.18014299, 11308.20168744, 11272.37840518,
          11384.60324421, 11516.71959935, 11254.12134252, 10768.60114948,
          11281.2171848 , 11369.44219812, 11271.99415651, 11373.25381717,
          11312.29265186, 11199.74306765, 11381.51356321, 11257.75873867,
          11241.70738359, 11486.96703966, 11209.47090335, 11336.84562091,
          11184.53612726, 11308.22839857, 11223.17159937, 11086.67939419,
          11403.8322146 , 11337.74044723, 11456.48032429, 11172.79910941,
          11015.98858462, 11451.10218858, 11455.94288846, 11301.13896509,
          11249.0294361 , 11222.38824049, 11336.25509915, 11380.29324968,
          11339.14311921, 11350.5783973 , 11317.86210208, 11308.04366141,
          11273.80185068, 11121.5229033 , 11104.22936232, 11518.9179203 ,
          11242.67762089, 11283.40770432, 11022.81369553, 11065.71847881,
          11117.98966247, 11279.3542932 , 11242.23306131, 11325.81245748,
          11124.39656722, 11297.73070243, 11215.21002581, 11161.68762906,
          11322.61331936, 11285.07583419, 11619.45878134, 11273.33783924,
          11366.90226848, 11299.87145815, 11242.45917369, 11329.97772221,
          11529.91979534, 11219.85048042, 11248.0645488 , 10973.1464567 ,
          11385.96675167, 11470.26874   , 11222.37084931, 11440.75450838,
          11265.74236778, 11205.21857254, 11225.87333198, 11288.90954709,
          11144.54134237, 11337.2126386 , 11306.34664738, 11291.39538363,
          11264.90716538, 11350.29241566, 11153.24811521, 11195.51217902,
          11395.91760561, 11297.04895862, 11102.44394376, 11230.7713691 ,
          11145.36141705, 11209.93299764, 11227.5002118 , 11230.83351328,
          11155.77879818, 11171.20544491, 11307.8912647 , 11300.45556855,
          11288.76074919, 11110.91209015, 11321.38842901, 11226.26532083,
          11316.17154856, 11149.5978187 , 11409.91991509, 11323.63379925,
          11284.39976859, 11678.33875217, 11297.16390532, 11256.73452313,
          11330.06543997, 11244.32396184, 11291.07279519, 11355.12631785,
          11280.20437267, 11257.00980784, 11155.16219864, 11225.12316968,
          11374.5574628 , 11168.39192433, 10897.27347418, 11230.46039997,
          11068.89885315, 11345.35178618, 11107.4302719 , 11394.59292531,
          11292.09667834, 11043.95240874, 11516.01366672, 11312.30035461,
          11219.6505027 , 11562.36905036, 10980.07434211, 11328.87274553,
          10912.43825737, 11255.06392282, 11344.26596242, 11663.14444428,
          11257.56279317, 11269.18211663, 11393.63666686, 11315.18431013,
          11355.6092498 , 11495.11464096, 11268.3069736 , 11484.80760556,
          11300.15003425, 11221.00191982, 11292.24728215, 11340.19093027,
          11252.03341622, 11074.69346362, 11285.32423262, 11282.84946978,
          11290.8485881 , 11211.20894078, 11251.75414093, 11224.09253991,
          11263.15462449, 11227.04425533, 11353.26991763, 11189.48613883,
          11418.77418817, 11313.77028268, 11279.95570271, 11226.181986  ,
          11299.56925552, 11366.30556385, 11076.41093642, 11360.73883292,
          11258.17774016, 11288.92525373, 11305.27093065, 11389.67569093,
          11302.51165685, 11318.2648393 , 11292.91317621, 11332.14699299,
          11589.32112162, 11295.12378415, 11325.80495248, 11350.34683921,
          11183.30800816, 11212.55886539, 11266.40745452, 11314.08228736,
          11306.32077089, 11284.86452214, 11196.48393837, 11297.63427262,
          11226.22765783, 11348.41510565, 11329.41916226, 11375.40069686,
          11536.51698227, 11094.81455385, 11244.87072533, 10695.81706214,
          11093.96909813, 11173.24422944, 11254.49418838, 11297.43183804]
      end
    end

    class Integers < TestDataset
      def initialize(size)
        @rng = Distribution::Normal.rng(4.3, 5.0)

        super
      end

      def populate
        size.times.map { @rng.call }
      end
    end

    def _evaluate_sketch_accuracy(sketch, data, eps, summary_stats = true)
      size = data.size
      # for quantile in TEST_QUANTILES:
      TEST_QUANTILES.each do |quantile|
        sketch_q = sketch.get_quantile_value(quantile)
        data_q = data.quantile(quantile)
        err = (sketch_q - data_q).abs
        expect(err - eps * (data_q).abs). to be <= 1e-15
      end

      expect(sketch.num_values).to eq(size)

      if summary_stats
        expect(sketch.sum).to be_within(1e-3).of(data.sum)
        expect(sketch.avg).to be_within(1e-3).of(data.avg)
      end
    end

    it "test_distributions" do
      datasets = [
        UniformForward,
        UniformBackward,
        UniformZoomIn,
        UniformZoomOut,
        UniformSqrt,
        Constant,
        NegativeUniformBackward,
        NegativeUniformForward,
        NumberLineBackward,
        NumberLineForward
      ]
      datasets.each do |dataset_klass|
        TEST_SIZES.each do |size|
          dataset = dataset_klass.new(size)
          sketch = described_class.new(*args)

          dataset.data.each do |value|
            sketch.add(value)
          end

          _evaluate_sketch_accuracy(sketch, dataset, TEST_REL_ACC)
        end
      end

      [Exponential, Lognormal, Bimodal, Mixed, Trimodal].each do |dataset_klass|
        dataset = dataset_klass.new
        sketch = described_class.new(*args)

        dataset.data.each do |value|
          sketch.add(value)
        end

        _evaluate_sketch_accuracy(sketch, dataset, TEST_REL_ACC)
      end
    end

    it "test_add_multiple" do
      sketch = described_class.new(*args)

      dataset = Integers.new(1000)
      counter = dataset.data.tally

      counter.each do |value, count|
        sketch.add(value, count)
      end

      _evaluate_sketch_accuracy(sketch, dataset, TEST_REL_ACC)
    end

    it "test_add_decimal" do
      sketch = described_class.new(*args)

      (0...100).each do |value|
        sketch.add(value, 1.1)
      end

      sketch.add(100, 110.0)

      data_median = 99
      sketch_median = sketch.get_quantile_value(0.5)
      err = (sketch_median - data_median).abs

      expect(err - TEST_REL_ACC * (data_median.abs)).to be <= 1e-15

      expect(sketch.count).to be_within(1e-3).of(110 * 2)
      expect(sketch.sum).to be_within(1e-3).of(5445 + 11000)
      expect(sketch.avg).to be_within(1e-3).of(74.75)
    end

    it "test_merge_equal" do
      parameters = [[35, 1], [1, 3], [15, 2], [40, 0.5]]
      # for size in TEST_SIZES:
      TEST_SIZES.each do |size|

        dataset = EmptyDataset.new(0)
        target_sketch = described_class.new(*args)

        parameters.each do |params|
          generator = Normal.new(size, params[0], params[1])
          sketch = described_class.new(*args)

          generator.data.each do |value|
            sketch.add(value)
            dataset.add(value)
          end

          target_sketch.merge(sketch)

          self._evaluate_sketch_accuracy(target_sketch, dataset, TEST_REL_ACC)
        end
      end
    end

    it "test_merge_unequal" do
      dataset = Lognormal.new
      sketch1 = described_class.new(*args)
      sketch2 = described_class.new(*args)

      rng = Random.new
      dataset.data.each do |value|
        if rng.rand > 0.7
          sketch1.add(value)
        else
          sketch2.add(value)
        end
      end

      sketch1.merge(sketch2)

      _evaluate_sketch_accuracy(sketch1, dataset, TEST_REL_ACC)
    end

    it "test_merge_mixed" do
      merged_dataset = EmptyDataset.new(0)
      merged_sketch = described_class.new(*args)

      [
        Normal.new(100),
        Exponential.new,
        Laplace.new,
        Bimodal.new
      ].each do |dataset|
        sketch = described_class.new(*args)

        dataset.data.each do |value|
          sketch.add(value)
          merged_dataset.add(value)
        end

        merged_sketch.merge(sketch)
      end

      _evaluate_sketch_accuracy(merged_sketch, merged_dataset, TEST_REL_ACC)
    end

    it "test_consistent_merge" do
      sketch1 = described_class.new(*args)
      sketch2 = described_class.new(*args)

      rng = Distribution::Normal.rng(37.4, 1.0)

      100.times.map { rng.call }.each do |value|
        sketch1.add(value)
      end

      sketch1.merge(sketch2)
      # sketch2 is still empty
      expect(sketch2.num_values).to eq(0)

      50.times.map { rng.call }.each do |value|
        sketch2.add(value)
      end

      sketch2_quantile_values = TEST_QUANTILES.map { |q| sketch2.get_quantile_value(q) }
      sketch2_values = [sketch2.sum, sketch2.avg, sketch2.num_values]

      sketch1.merge(sketch2)

      #### missing spec

      100.times.map { rng.call }.each do |value|
        sketch1.add(value)
      end

      # changes to sketch1 does not affect sketch2 after merge
      TEST_QUANTILES.each_with_index do |q, index|
        expect(sketch2.get_quantile_value(q)).to be_within(1e-3).of(sketch2_quantile_values[index])
      end
      expect(sketch2.sum).to be_within(1e-3).of(sketch2_values[0])
      expect(sketch2.avg).to be_within(1e-3).of(sketch2_values[1])
      expect(sketch2.num_values).to be_within(1e-3).of(sketch2_values[2])

      sketch3 = described_class.new(*args)
      sketch3.merge(sketch2)

      # merging to an empty sketch does not change sketch2
      TEST_QUANTILES.each_with_index do |q, index|
        expect(sketch2.get_quantile_value(q)).to be_within(1e-3).of(sketch2_quantile_values[index])
      end
      expect(sketch2.sum).to be_within(1e-3).of(sketch2_values[0])
      expect(sketch2.avg).to be_within(1e-3).of(sketch2_values[1])
      expect(sketch2.num_values).to be_within(1e-3).of(sketch2_values[2])
    end
  end

  describe DDSketch::DDSketch do
    it_should_behave_like "test sketch", TEST_REL_ACC
  end

  describe DDSketch::LogCollapsingLowestDenseDDSketch do
    it_should_behave_like "test sketch", TEST_REL_ACC, 1024
  end

  describe DDSketch::LogCollapsingHighestDenseDDSketch do
    it_should_behave_like "test sketch", TEST_REL_ACC, 1024
  end
end
